var ABMFileManager=function(e,t){var i,s,f=this;function a(){console.log(f.isrtl),f.isBig=!f.isBig,f.isBig?$("#"+f.id+"-view-i").html("view_list"):$("#"+f.id+"-view-i").html("view_module"),w()}function n(){f.options.canUpload?$("#"+f.id+"-background").removeClass("hide"):$("#"+f.id+"-background").hasClass("hide")||$("#"+f.id+"-background").addClass("hide");var e=$("#"+f.id+"-buttons");e.html("");var t="";f.options.canUpload?$("#"+f.id+"-upload").length?$("#"+f.id+"-upload").removeClass("hide"):(t="",f.ttupload&&(t='<span class="abmfiletooltiptext abmfiletooltiptext'+f.theme+'">'+f.ttupload+"</span>"),e.append('<li id="'+f.id+'-upload" style="margin-left:15px;margin-right:10px;float:right;cursor: pointer" class="abmfiletooltip abmfiletooltip'+f.theme+'"><div><label style="cursor: pointer" for="'+f.id+'-input" class="material-icons white-text">cloud_upload</label>'+t+'<input id="'+f.id+'-input" type="file" class="hide"/></div></li>')):$("#"+f.id+"-upload").length&&($("#"+f.id+"-upload").hasClass("hide")||$("#"+f.id+"-upload").addClass("hide")),f.options.canDownload?$("#"+f.id+"-download").length?$("#"+f.id+"-download").removeClass("hide"):(t="",f.ttdownload&&(t='<span class="abmfiletooltiptext abmfiletooltiptext'+f.theme+'">'+f.ttdownload+"</span>"),e.append('<li id="'+f.id+'-download" style="margin-left: 15px;float:right;cursor: pointer" class="abmfiletooltip abmfiletooltip'+f.theme+' hide"><a><i class="material-icons white-text">file_download</i></a>'+t+"</li>")):$("#"+f.id+"-download").length&&($("#"+f.id+"-download").hasClass("hide")||$("#"+f.id+"-download").addClass("hide")),f.options.canDelete?$("#"+f.id+"-delete").length?$("#"+f.id+"-delete").removeClass("hide"):(t="",f.ttdelete&&(t='<span class="abmfiletooltiptext abmfiletooltiptext'+f.theme+'">'+f.ttdelete+"</span>"),e.append('<li id="'+f.id+'-delete" style="margin-left: 15px;float:right;cursor: pointer" class="abmfiletooltip abmfiletooltip'+f.theme+' hide"><a><i class="material-icons white-text">delete_forever</i></a>'+t+"</li>")):$("#"+f.id+"-delete").length&&($("#"+f.id+"-delete").hasClass("hide")||$("#"+f.id+"-delete").addClass("hide")),f.options.canCreate?$("#"+f.id+"-create").length?$("#"+f.id+"-create").removeClass("hide"):(t="",f.ttcreate&&(t='<span class="abmfiletooltiptext abmfiletooltiptext'+f.theme+'">'+f.ttcreate+"</span>"),e.append('<li id="'+f.id+'-create" style="margin-left: 15px;float:right;cursor: pointer" class="abmfiletooltip abmfiletooltip'+f.theme+' hide"><a><i class="material-icons white-text">folder_open</i></a>'+t+"</li>")):$("#"+f.id+"-create").length&&($("#"+f.id+"-create").hasClass("hide")||$("#"+f.id+"-create").addClass("hide")),f.options.canPaste?$("#"+f.id+"-paste").length?$("#"+f.id+"-paste").removeClass("hide"):(t="",f.ttpaste&&(t='<span class="abmfiletooltiptext abmfiletooltiptext'+f.theme+'">'+f.ttpaste+"</span>"),e.append('<li id="'+f.id+'-paste" style="margin-left: 15px;float:right;cursor: pointer" class="abmfiletooltip abmfiletooltip'+f.theme+' hide"><a><i class="material-icons white-text">content_paste</i></a>'+t+"</li>")):$("#"+f.id+"-paste").length&&($("#"+f.id+"-paste").hasClass("hide")||$("#"+f.id+"-paste").addClass("hide")),f.options.canCopy?$("#"+f.id+"-copy").length?$("#"+f.id+"-copy").removeClass("hide"):(t="",f.ttcopy&&(t='<span class="abmfiletooltiptext abmfiletooltiptext'+f.theme+'">'+f.ttcopy+"</span>"),e.append('<li id="'+f.id+'-copy" style="margin-left: 15px;float:right;cursor: pointer" class="abmfiletooltip abmfiletooltip'+f.theme+' hide"><a><i class="material-icons white-text">content_copy</i></a>'+t+"</li>")):$("#"+f.id+"-copy").length&&($("#"+f.id+"-copy").hasClass("hide")||$("#"+f.id+"-copy").addClass("hide")),f.options.canCut?$("#"+f.id+"-cut").length?$("#"+f.id+"-cut").removeClass("hide"):(t="",f.ttcut&&(t='<span class="abmfiletooltiptext abmfiletooltiptext'+f.theme+'">'+f.ttcut+"</span>"),e.append('<li id="'+f.id+'-cut" style="margin-left: 15px;float:right;cursor: pointer" class="abmfiletooltip abmfiletooltip'+f.theme+' hide"><a><i class="material-icons white-text">content_cut</i></a>'+t+"</li>")):$("#"+f.id+"-cut").length&&($("#"+f.id+"-cut").hasClass("hide")||$("#"+f.id+"-cut").addClass("hide")),f.options.canRename?$("#"+f.id+"-rename").length?$("#"+f.id+"-rename").removeClass("hide"):(t="",f.ttrename&&(t='<span class="abmfiletooltiptext abmfiletooltiptext'+f.theme+'">'+f.ttrename+"</span>"),e.append('<li id="'+f.id+'-rename" style="margin-left: 15px;float:right;cursor: pointer" class="abmfiletooltip abmfiletooltip'+f.theme+' hide"><a><i class="material-icons white-text">create</i></a>'+t+"</li>")):$("#"+f.id+"-rename").length&&($("#"+f.id+"-rename").hasClass("hide")||$("#"+f.id+"-rename").addClass("hide")),f.options.canUpload,f.options.canDownload?f.supportsTouch?($("#"+f.id).find("#"+f.id+"-download")[0].removeEventListener("touchend",l),$("#"+f.id).find("#"+f.id+"-download")[0].addEventListener("touchend",l,!1)):($("#"+f.id).find("#"+f.id+"-download")[0].removeEventListener("click",l),$("#"+f.id).find("#"+f.id+"-download")[0].addEventListener("click",l,!1)):$("#"+f.id).find("#"+f.id+"-download").length&&$("#"+f.id).find("#"+f.id+"-download")[0].removeEventListener("touchend",l),f.options.canDelete?f.supportsTouch?($("#"+f.id).find("#"+f.id+"-delete")[0].removeEventListener("touchend",u),$("#"+f.id).find("#"+f.id+"-delete")[0].addEventListener("touchend",u,!1)):($("#"+f.id).find("#"+f.id+"-delete")[0].removeEventListener("click",u),$("#"+f.id).find("#"+f.id+"-delete")[0].addEventListener("click",u,!1)):$("#"+f.id).find("#"+f.id+"-delete").length&&$("#"+f.id).find("#"+f.id+"-delete")[0].removeEventListener("touchend",u),f.options.canCreate?f.supportsTouch?($("#"+f.id).find("#"+f.id+"-create")[0].removeEventListener("touchend",v),$("#"+f.id).find("#"+f.id+"-create")[0].addEventListener("touchend",v,!1)):($("#"+f.id).find("#"+f.id+"-create")[0].removeEventListener("click",v),$("#"+f.id).find("#"+f.id+"-create")[0].addEventListener("click",v,!1)):$("#"+f.id).find("#"+f.id+"-create").length&&$("#"+f.id).find("#"+f.id+"-create")[0].removeEventListener("touchend",v),f.options.canPaste?f.supportsTouch?($("#"+f.id).find("#"+f.id+"-paste")[0].removeEventListener("touchend",p),$("#"+f.id).find("#"+f.id+"-paste")[0].addEventListener("touchend",p,!1)):($("#"+f.id).find("#"+f.id+"-paste")[0].removeEventListener("click",p),$("#"+f.id).find("#"+f.id+"-paste")[0].addEventListener("click",p,!1)):$("#"+f.id).find("#"+f.id+"-paste").length&&$("#"+f.id).find("#"+f.id+"-paste")[0].removeEventListener("touchend",p),f.options.canCopy?f.supportsTouch?($("#"+f.id).find("#"+f.id+"-copy")[0].removeEventListener("touchend",m),$("#"+f.id).find("#"+f.id+"-copy")[0].addEventListener("touchend",m,!1)):($("#"+f.id).find("#"+f.id+"-copy")[0].removeEventListener("click",m),$("#"+f.id).find("#"+f.id+"-copy")[0].addEventListener("click",m,!1)):$("#"+f.id).find("#"+f.id+"-copy").length&&$("#"+f.id).find("#"+f.id+"-copy")[0].removeEventListener("touchend",m),f.options.canCut?f.supportsTouch?($("#"+f.id).find("#"+f.id+"-cut")[0].removeEventListener("touchend",d),$("#"+f.id).find("#"+f.id+"-cut")[0].addEventListener("touchend",d,!1)):($("#"+f.id).find("#"+f.id+"-cut")[0].removeEventListener("click",d),$("#"+f.id).find("#"+f.id+"-cut")[0].addEventListener("click",d,!1)):$("#"+f.id).find("#"+f.id+"-cut").length&&$("#"+f.id).find("#"+f.id+"-cut")[0].removeEventListener("touchend",d),f.options.canRename?f.supportsTouch?($("#"+f.id).find("#"+f.id+"-rename")[0].removeEventListener("touchend",h),$("#"+f.id).find("#"+f.id+"-rename")[0].addEventListener("touchend",h,!1)):($("#"+f.id).find("#"+f.id+"-rename")[0].removeEventListener("click",h),$("#"+f.id).find("#"+f.id+"-rename")[0].addEventListener("click",h,!1)):$("#"+f.id).find("#"+f.id+"-rename").length&&$("#"+f.id).find("#"+f.id+"-rename")[0].removeEventListener("touchend",h),E()}function o(){f.isBig?f.supportsTouch?$("#"+f.id).find(".abmfilebig:not(.abmtypefolder)").each(function(){this.removeEventListener("touchend",g),this.addEventListener("touchend",g,!1)}):$("#"+f.id).find(".abmfilebig").each(function(){this.removeEventListener("click",g),this.addEventListener("click",g,!1)}):f.supportsTouch?$("#"+f.id).find(".abmfilelistitem:not(.abmtypefolder)").each(function(){this.removeEventListener("touchend",g),this.addEventListener("touchend",g,!1)}):$("#"+f.id).find(".abmfilelistitem").each(function(){this.removeEventListener("click",g),this.addEventListener("click",g,!1)})}function l(e){var t=r();b4j_raiseEvent("page_parseevent",{eventname:f.id+"_requestfordownload",eventparams:"jsonlist",jsonlist:t})}function d(e){f.selectedFiles={},f.CopyCutFolder=f.CurrentFolder,f.CopyOrCut="cut";for(var t=0;t<f.files.length;t++){file=f.files[t];var i=$('[data-pos="'+t+'"]');file.isActive?(file.isCut=!0,file.isCopy=!1,i.hasClass("copy")&&i.removeClass("copy"),i.hasClass("move")||i.addClass("move"),f.selectedFiles[""+file.name]=b(file)):(file.isCut=!1,file.isCopy=!1,i.removeClass("move"),i.removeClass("copy"))}E()}function r(){for(var e={},t=[],i=0;i<f.files.length;i++){var s=f.files[i];if(s.isActive){var a={};a.icon=s.icon,a.name=s.name,a.folder=s.folder,a.size=s.size,a.date=s.date,a.image=s.image,t.push(a)}}return e.files=t,JSON.stringify(e)}function c(){var e={},t=[];for(var i in f.selectedFiles){var s=f.selectedFiles[i],a={};a.icon=s.icon,a.name=s.name,a.folder=s.folder,a.size=s.size,a.date=s.date,a.image=s.image,t.push(a)}return e.files=t,JSON.stringify(e)}function m(e){f.selectedFiles={},f.CopyCutFolder=f.CurrentFolder,f.CopyOrCut="copy";for(var t=0;t<f.files.length;t++){file=f.files[t];var i=$('[data-pos="'+t+'"]');file.isActive?(file.isCut=!1,file.isCopy=!0,i.hasClass("move")&&i.removeClass("move"),i.hasClass("copy")||i.addClass("copy"),f.selectedFiles[""+file.name]=b(file)):(file.isCut=!1,file.isCopy=!1,i.removeClass("move"),i.removeClass("copy"))}E()}function p(e){if("cut"==f.CopyOrCut){var t=c();b4j_raiseEvent("page_parseevent",{eventname:f.id+"_requestforcutpaste",eventparams:"fromfolder,jsonlist",fromfolder:f.CopyCutFolder,jsonlist:t})}else t=c(),b4j_raiseEvent("page_parseevent",{eventname:f.id+"_requestforcopypaste",eventparams:"fromfolder,jsonlist",fromfolder:f.CopyCutFolder,jsonlist:t});E()}function u(e){var t=r();b4j_raiseEvent("page_parseevent",{eventname:f.id+"_requestfordelete",eventparams:"jsonlist",jsonlist:t}),E()}function h(e){for(var t,i=0;i<f.files.length&&!(t=f.files[i]).isActive;i++);b4j_raiseEvent("page_parseevent",{eventname:f.id+"_requestforrename",eventparams:"oldfilename",oldfilename:t.name})}function v(e){b4j_raiseEvent("page_parseevent",{eventname:f.id+"_requestforcreatefolder",eventparams:""})}function g(e){if(!abmdragging){$(this).toggleClass("active");var t=$(this).hasClass("active"),i=f.files[$(this).data("pos")];(i.isActive=t)?f.selected++:f.selected--,f.selectedFiles={};for(var s=0;s<f.files.length;s++){(i=f.files[s]).isCut=!1,i.isCopy=!1;var a=$('[data-pos="'+s+'"]');a.removeClass("move"),a.removeClass("copy")}return $("#"+f.id+"-info").html('<i class="fa fa-check-circle" style="position: relative;top: 2px;left: -5px;font-size: 24px;"></i><b>'+f.selected+"</b>"),E(),e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue&&(e.returnValue=!1),!1}}function b(e){var t={};return t.icon=e.icon,t.name=e.name,t.folder=e.folder,t.size=e.size,t.date=e.date,t.image=e.image,t}function C(){if(!$(this).hasClass("active")){var e=$(this).attr("id").substring(f.id.length+1),t=f.folders[e];b4j_raiseEvent("page_parseevent",{eventname:f.id+"_folderchange",eventparams:"folder",folder:t.fullPath})}}function y(){var e=$(this).attr("id").substring(f.id.length+2),t=f.crumbs[e];b4j_raiseEvent("page_parseevent",{eventname:f.id+"_folderchange",eventparams:"folder",folder:t.fullPath})}function w(){x();var e=$("#"+f.id).find(".abmfilesall").find(".col");if(f.FileCounter=0,f.supportsTouch?$("#"+f.id).find(".abmtypefolder").each(function(){$(this).off("touchstart")}):$("#"+f.id).find(".abmtypefolder").each(function(){$(this).off("dblclick")}),f.isBig)for(var t=0;t<f.files.length;t++){var i=f.files[t];""!=f.Filter?-1<i.name.toLowerCase().indexOf(f.Filter)&&f.AddAFile(e,i):f.AddAFile(e,i)}else for($newDiv='<div class="row abmfilelistheader abmfilelistheader'+f.theme+'"><div class="col s12 m9 l5 offset-s0 offset-m0 offset-l0"><a ><span>'+f.options.Name+'</span></a></div><div class="col s0 m3 l3 offset-s0 offset-m0 offset-l0 abmfileright abmfilelistitemsize"><a ><span>'+f.options.Size+'</span></a></div><div class="col s0 m0 l4 offset-s0 offset-m0 offset-l0 abmfilelistitemdate"><a ><span>'+f.options.Date+"</span></a></div></div>",e.append($newDiv),t=0;t<f.files.length;t++)i=f.files[t],""!=f.Filter?-1<i.name.toLowerCase().indexOf(f.Filter)&&f.AddAFile(e,i):f.AddAFile(e,i);o(),f.supportsTouch?$("#"+f.id).find(".abmtypefolder").each(function(){$(this).on("touchstart",function(e){if($(this).attr("id"),!f.tapedTwice)return f.tapedTwice=!0,setTimeout(function(){f.tapedTwice=!1},300),!1;event.preventDefault();var t,i=f.files[$(this).data("pos")];t=""!=f.CurrentFolder?f.CurrentFolder+"/"+i.name:i.name,b4j_raiseEvent("page_parseevent",{eventname:f.id+"_folderchange",eventparams:"folder",folder:t})})}):$("#"+f.id).find(".abmtypefolder").each(function(){$(this).on("dblclick",function(e){e.preventDefault?e.preventDefault():e.returnValue&&(e.returnValue=!1);var t,i=f.files[$(this).data("pos")];t=""!=f.CurrentFolder?f.CurrentFolder+"/"+i.name:i.name,b4j_raiseEvent("page_parseevent",{eventname:f.id+"_folderchange",eventparams:"folder",folder:t})})})}function x(){f.isBig?f.supportsTouch?$("#"+f.id).find(".abmfilebig").each(function(){this.removeEventListener("touchend",g)}):$("#"+f.id).find(".abmfilebig").each(function(){this.removeEventListener("click",g)}):f.supportsTouch?$("#"+f.id).find(".abmfilelistitem").each(function(){this.removeEventListener("touchend",g)}):$("#"+f.id).find(".abmfilelistitem").each(function(){this.removeEventListener("click",g)}),$("#"+f.id).find(".abmfilesall").find(".col").html("")}function E(){for(var e=0,t=0;t<f.files.length;t++)!0===f.files[t].isActive&&e++;f.options.canCreate&&$("#"+f.id+"-create").removeClass("hide"),0<e?(f.options.canDownload&&$("#"+f.id+"-download").removeClass("hide"),f.options.canCut&&$("#"+f.id+"-cut").removeClass("hide"),f.options.canCopy&&$("#"+f.id+"-copy").removeClass("hide"),f.options.canPaste&&(0<Object.keys(f.selectedFiles).length?$("#"+f.id+"-paste").removeClass("hide"):$("#"+f.id+"-paste").hasClass("hide")||$("#"+f.id+"-paste").addClass("hide")),f.options.canDelete&&$("#"+f.id+"-delete").removeClass("hide"),f.options.canRename&&(1==e?$("#"+f.id+"-rename").removeClass("hide"):$("#"+f.id+"-rename").hasClass("hide")||$("#"+f.id+"-rename").addClass("hide"))):(f.options.canDownload&&($("#"+f.id+"-download").hasClass("hide")||$("#"+f.id+"-download").addClass("hide")),f.options.canCut&&($("#"+f.id+"-cut").hasClass("hide")||$("#"+f.id+"-cut").addClass("hide")),f.options.canCopy&&($("#"+f.id+"-copy").hasClass("hide")||$("#"+f.id+"-copy").addClass("hide")),f.options.canDelete&&($("#"+f.id+"-delete").hasClass("hide")||$("#"+f.id+"-delete").addClass("hide")),f.options.canRename&&($("#"+f.id+"-rename").hasClass("hide")||$("#"+f.id+"-rename").addClass("hide")),f.options.canPaste&&(0<Object.keys(f.selectedFiles).length?$("#"+f.id+"-paste").removeClass("hide"):$("#"+f.id+"-paste").hasClass("hide")||$("#"+f.id+"-paste").addClass("hide")))}f.id=e,f.isBig=t.isBig,f.isrtl=t.rtl?"abmrtl":"",f.files={},f.folders={},f.crumbs={},f.options=t,f.supportsTouch=!0,f.selectedFiles={},f.IsDragging=!1,f.FileCounter=0,f.singleClickCalled=!1,f.CurrentFolder="",f.Filter="",f.counter=0,f.CopyCutFolder="",f.CopyOrCut="",f.tapedTwice=!1,f.theme=t.theme,"desktop"==$("#devicetype").html()&&(f.supportsTouch=!1),f.selected=0,s="Drop zone",f.supportsTouch&&(s=""),$("#"+f.id).html("")&&$("#"+f.id).html('<div class="abmfileheader abmfileheader'+f.theme+'"><div class="row"><div class="col s4 m5 l6 offset-s0 offset-m0 offset-l0 transparent" style="height: 54px; padding-right:0px"><div class="abmfilebreadcrumbs"></div></div><div class="col s8 m7 l6 offset-s0 offset-m0 offset-l0 transparent" style="padding-left:0px; padding-right: 2px"><ul><li id="'+f.id+'-view" style="float:right;cursor: pointer;margin-right:10px" class=""><a><i id="'+f.id+'-view-i" class="material-icons white-text">view_module</i></a></li><li id="'+f.id+'-search" style="margin-left: 15px;float:right;cursor: pointer" class="'+f.isrtl+'"><div id="'+f.id+'-form" class="abmfilebuttons"><input id="'+f.id+'-filter" class="abmfileinput abmfileinput'+f.theme+'" type="search" placeholder="Search"></div></li></ul></div></div></div><div class="abmfilewrapper"><div class="row abmfileheight"><div class="col s0 m0 l4 offset-s0 offset-m0 offset-l0 abmfilesidebar abmfilesidebar'+f.theme+'"><div class="abmfoldersall"></div></div><div class="col s12 m12 l8 offset-s0 offset-m0 offset-l0 transparent abmfilesallwrapper"><div class="abmfilesall"><div id="'+f.id+'-background" class="abmfiledropzone abmfiledropzone'+f.theme+'" ><div class="valign-wrapper" style="height: 100%;"><p id="bg-text" style="width: 100%;" class="center-align">'+s+'</p></div></div><div class="col s12 m12 l12 offset-s0 offset-m0 offset-l0 abmfileoverflow"></div></div></div></div></div><div class="abmfilefooter abmfilefooter'+f.theme+'"><div class="row"><div class="col s2 m4 l4 offset-s0 offset-m0 offset-l0 transparent"  style="padding-right: 0px"><ul><li class="abmfileinfo abmfileinfo'+f.theme+'"><span id="'+f.id+'-info"><i class="fa fa-check-circle" style="position: relative;top: 2px;left: -5px;font-size: 24px"></i>0</span></li></ul></div><div class="col s10 m8 l8 offset-s0 offset-m0 offset-l0 transparent" style="padding-left: 0px; padding-right: 2px"><ul id="'+f.id+'-buttons"></ul></div></div></div>'),$("#"+f.id+"-filter").on("input",function(e){return f.Filter=""+$("#"+f.id+"-filter").val().toLowerCase(),w(),!1}),n(),f.isBig?$("#"+f.id+"-view-i").html("view_list"):$("#"+f.id+"-view-i").html("view_module"),f.supportsTouch?$("#"+f.id+"-view-i")[0].addEventListener("touchend",a,!1):$("#"+f.id+"-view-i")[0].addEventListener("click",a,!1),o(),$("#"+f.id+"-background").dmUploader({maxFileSize:f.options.maxSize,parent:f,extFilter:f.options.Exts,url:f.options.url}),$(document).on("dragleave",function(e){window.clearTimeout(i),i=window.setTimeout(function(){$("#"+f.id+"-background").css("z-index",0)},85)}),$(document).on("dragover",function(e){var t=e.originalEvent.dataTransfer;t.types&&(t.types.indexOf?-1!=t.types.indexOf("Files"):t.types.contains("Files"))&&($("#"+f.id+"-background").css("z-index",1e4),window.clearTimeout(i))}),this.RefreshOptions=function(e){e.theme!=f.theme&&($("#"+f.id).addClass("abmfilemanager"+e.theme).removeClass("abmfilemanager"+f.theme),$("#"+f.id).addClass("abmfileheader"+e.theme).removeClass("abmfileheader"+f.theme),$("#"+f.id).addClass("abmfilefooter"+e.theme).removeClass("abmfilefooter"+f.theme),$("#"+f.id).addClass("abmfilebreadcrumb"+e.theme).removeClass("abmfilebreadcrumb"+f.theme),$("#"+f.id).addClass("abmfilebreadcrumbsep"+e.theme).removeClass("abmfilebreadcrumbsep"+f.theme),$("#"+f.id).addClass("abmfilesidebar"+e.theme).removeClass("abmfilesidebar"+f.theme),$("#"+f.id).addClass("abmfilefolder"+e.theme).removeClass("abmfilefolder"+f.theme),$("#"+f.id).addClass("abmfilebig"+e.theme).removeClass("abmfilebig"+f.theme),$("#"+f.id).addClass("abmfileinput"+e.theme).removeClass("abmfileinput"+f.theme),$("#"+f.id).addClass("abmfilelistheader"+e.theme).removeClass("abmfilelistheader"+f.theme),$("#"+f.id).addClass("abmfilelistitem"+e.theme).removeClass("abmfilelistitem"+f.theme),$("#"+f.id).addClass("abmfilelistitem-file"+e.theme).removeClass("abmfilelistitem-file"+f.theme),$("#"+f.id).addClass("abmfileinfo"+e.theme).removeClass("abmfileinfo"+f.theme),$("#"+f.id).addClass("abmfiletooltip"+e.theme).removeClass("abmfiletooltip"+f.theme),$("#"+f.id).addClass("abmfiletooltiptext"+e.theme).removeClass("abmfiletooltiptext"+f.theme),$("#"+f.id).addClass("abmfiledropzone"+e.theme).removeClass("abmfiledropzone"+f.theme)),f.theme=e.theme;var t=!1;f.options.isBig!=e.isBig&&(t=!0),f.options=e,n(),t&&w()},this.StartDownload=function(e,t,i){var s,a,n,o;s=e,a=t,n=i,(o=new XMLHttpRequest).open("GET",s,!0),o.responseType="blob",o.onload=function(e){download(o.response,a,"application/zip")},o.addEventListener("loadend",function(e){b4j_raiseEvent("page_parseevent",{eventname:f.id+"_downloaded",eventparams:"jobcode",jobcode:n})}),o.send()},this.getSelected=function(){return r()},this.loadFolder=function(e){f.Filter="",$("#"+f.id+"-filter").val("");var t=$.parseJSON(e);f.files=t.files,f.folders=t.folders;var i=$("#"+f.id).find(".abmfilebreadcrumbs");i.html(""),f.crumbs=t.crumbs,f.supportsTouch?$("#"+f.id).find(".abmfilebreadcrumb.last").each(function(){this.removeEventListener("touchend",y)}):$("#"+f.id).find(".abmfilebreadcrumb.last").each(function(){this.removeEventListener("click",y)});for(var s=0,a=0;a<f.crumbs.length;a++)f.crumbs[a].fullPath="",a==f.crumbs.length-1?(0<a&&i.append('<div class="abmfilebreadcrumbsep abmfilebreadcrumbsep'+f.theme+' last">&lt;</div>'),i.append('<a id="'+f.id+"_C"+a+'" class="abmfilebreadcrumb abmfilebreadcrumb'+f.theme+' last">'+f.crumbs[a].name+"</a>"),s=a):(i.append('<a id="'+f.id+"_C"+a+'" class="abmfilebreadcrumb abmfilebreadcrumb'+f.theme+'">'+f.crumbs[a].name+"</a>"),i.append('<div class="abmfilebreadcrumbsep abmfilebreadcrumbsep'+f.theme+'">&gt;</div>'));f.supportsTouch?$("#"+f.id).find(".abmfilebreadcrumb.last").each(function(){this.addEventListener("touchend",y,!1)}):$("#"+f.id).find(".abmfilebreadcrumb.last").each(function(){this.addEventListener("click",y,!1)}),f.supportsTouch?$("#"+f.id).find(".abmfilefolder").each(function(){this.removeEventListener("touchend",C)}):$("#"+f.id).find(".abmfilefolder").each(function(){this.removeEventListener("click",C)}),(i=$("#"+f.id).find(".abmfoldersall")).html("");var n=[];for(a=0;a<f.folders.length;a++){var o=f.folders[a],l="folder",d="keyboard_arrow_right";o.isOpen=!1,"true"===o.open&&(l="folder_open",d="keyboard_arrow_down",o.isOpen=!0);var r="";for(o.isActive=!1,"true"===o.active&&(o.isActive=!0,r=" active ");n.length-1>=o.level;)n.pop();n.push(o.name),o.fullPath=n.join("/").replace("//","/"),o.fullPath=o.fullPath.substring(f.folders[0].name.length+1),o.isActive&&(f.CurrentFolder=o.fullPath);var c='<div class="row"><div class="col s12 m12 l12 offset-s0 offset-m0 offset-l0"><div id="'+f.id+"_"+a+'" class="abmfilefolder abmfilefolder'+f.theme+r+" abmfolderlev"+o.level+'"><a><i class="material-icons">'+d+'</i></a><a ><i class="material-icons">'+l+"</i><span class='"+f.isrtl+"'>"+o.name+"</span></a></div></div></div>";i.append(c)}f.crumbs[s].fullPath=f.CurrentFolder.substring(0,f.CurrentFolder.length-f.crumbs[s].name.length-1),f.supportsTouch?$("#"+f.id).find(".abmfilefolder").each(function(){this.addEventListener("touchend",C,!1)}):$("#"+f.id).find(".abmfilefolder").each(function(){this.addEventListener("click",C,!1)}),f.selected=0,$("#"+f.id+"-info").html('<i class="fa fa-check-circle" style="position: relative;top: 2px;left: -5px;font-size: 24px;"></i><b>'+f.selected+"</b>"),w(),E()},this.AddAFile=function(e,t){var i="",s="",a="",n="";if(f.isBig){!0===t.isActive&&(s=" active "),!0===t.isCopy&&(a=" copy "),!0===t.isCut&&(n=" move ");var o="",l=" abmtypefolder ";if(""==t.image){if(""!=t.icon)switch("folder"!=t.icon&&(o="padding-top: 12px",l=""),t.icon.substring(0,3)){case"mdi":i='<a data-pos="'+f.FileCounter+'" class="abmfilebig abmfilebig'+f.theme+s+a+n+l+'"><div class="abmfilethumbnailbig"><i class="'+t.icon+' medium" style="position: relative;top: -14px;left: -14px;"></i></div><div style="'+o+'" class="abmfilebiglabel '+f.isrtl+'">'+t.name+"</div></a>";break;case"fa ":case"fa-":i='<a data-pos="'+f.FileCounter+'" class="abmfilebig abmfilebig'+f.theme+s+a+n+l+'"><div class="abmfilethumbnailbig"><i class="'+t.icon+' medium" style="position: relative;top: -14px;left: -14px;"></i></div><div  style="'+o+'" class="abmfilebiglabel '+f.isrtl+'">'+t.name+"</div></a>";break;case"abm":console.log("abm icons are not supported!");break;default:i='<a data-pos="'+f.FileCounter+'" class="abmfilebig abmfilebig'+f.theme+s+a+n+l+'"><div class="abmfilethumbnailbig"><i class="material-icons medium" style="position: relative;top: -14px;left: -14px;">'+t.icon+'</i></div><div style="'+o+'"  class="abmfilebiglabel '+f.isrtl+'">'+t.name+"</div></a>"}}else i='<a data-pos="'+f.FileCounter+'" class="abmfilebig abmfilebig'+f.theme+s+a+n+'"><div class="abmfilethumbnailbig"><img style="margin-top: -18px;margin-left: -18px" width=64 height=64 src="'+t.image+'"></img></div><div class="abmfilebiglabelimg '+f.isrtl+'">'+t.name+"</div></a>";e.append(i)}else{if(!0===t.isActive&&(s=" active "),!0===t.isCopy&&(a=" copy "),!0===t.isCut&&(n=" move "),l=" abmtypefolder ",(o="")==t.image){if(""!=t.icon)switch("folder"!=t.icon&&(o="top: 0px",l=""),t.icon.substring(0,3)){case"mdi":i='<div data-pos="'+f.FileCounter+'" class="row abmfilelistitem abmfilelistitem'+f.theme+s+a+n+l+'"><div class="col s12 m9 l5 offset-s0 offset-m0 offset-l0"><a class="abmfilelistitem-file abmfilelistitem-file'+f.theme+'"><i style="'+o+'" class="'+t.icon+'"></i><span>'+t.name+'</span></a></div><div class="col s0 m3 l3 offset-s0 offset-m0 offset-l0 abmfileright abmfilelistitemsize"><span>'+t.size+'</span></div><div class="col s0 m0 l4 offset-s0 offset-m0 offset-l0 abmfilelistitemdate"><span>'+t.date+"</span></div></div>";break;case"fa ":case"fa-":i='<div data-pos="'+f.FileCounter+'" class="row abmfilelistitem abmfilelistitem'+f.theme+s+a+n+l+'"><div class="col s12 m9 l5 offset-s0 offset-m0 offset-l0"><a class="abmfilelistitem-file abmfilelistitem-file'+f.theme+'"><i style="'+o+'" class="'+t.icon+'"></i><span>'+t.name+'</span></a></div><div class="col s0 m3 l3 offset-s0 offset-m0 offset-l0 abmfileright abmfilelistitemsize"><span>'+t.size+'</span></div><div class="col s0 m0 l4 offset-s0 offset-m0 offset-l0 abmfilelistitemdate"><span>'+t.date+"</span></div></div>";break;case"abm":console.log("abm icons are not supported!");break;default:i='<div data-pos="'+f.FileCounter+'" class="row abmfilelistitem abmfilelistitem'+f.theme+s+a+n+l+'"><div class="col s12 m9 l5 offset-s0 offset-m0 offset-l0"><a class="abmfilelistitem-file abmfilelistitem-file'+f.theme+'"><i style="'+o+'" class="material-icons">'+t.icon+"</i><span>"+t.name+'</span></a></div><div class="col s0 m3 l3 offset-s0 offset-m0 offset-l0 abmfileright abmfilelistitemsize"><span>'+t.size+'</span></div><div class="col s0 m0 l4 offset-s0 offset-m0 offset-l0 abmfilelistitemdate"><span>'+t.date+"</span></div></div>"}}else i='<div data-pos="'+f.FileCounter+'" class="row abmfilelistitem abmfilelistitem'+f.theme+s+a+n+'"><div class="col s12 m9 l5 offset-s0 offset-m0 offset-l0"><a class="abmfilelistitem-file abmfilelistitem-file'+f.theme+'"><img style="margin-right: 10px;position: relative;top: 3px;" width=16 height=16 src="'+t.image+'"></img><span>'+t.name+'</span></a></div><div class="col s0 m3 l3 offset-s0 offset-m0 offset-l0 abmfileright abmfilelistitemsize"><span>'+t.size+'</span></div><div class="col s0 m0 l4 offset-s0 offset-m0 offset-l0 abmfilelistitemdate"><span>'+t.date+"</span></div></div>";e.append(i)}f.FileCounter++},this.clearFolder=function(){x()}};!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.download=t()}(this,function(){return function t(e,i,s){var a,n,o=window,l="application/octet-stream",d=s||l,r=e,c=!i&&!s&&r,f=document.createElement("a"),m=function(e){return String(e)},p=o.Blob||o.MozBlob||o.WebKitBlob||m,u=i||"download";if(p=p.call?p.bind(o):Blob,"true"===String(this)&&(d=(r=[r,d])[0],r=r[1]),c&&c.length<2048&&(u=c.split("/").pop().split("?")[0],f.href=c,-1!==f.href.indexOf(c))){var h=new XMLHttpRequest;return h.open("GET",c,!0),h.responseType="blob",h.onload=function(e){t(e.target.response,u,l)},setTimeout(function(){h.send()},0),h}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(r)){if(!(2096103.424<r.length&&p!==m))return navigator.msSaveBlob?navigator.msSaveBlob(C(r),u):$(r);d=(r=C(r)).type||l}else if(/([\x80-\xff])/.test(r)){for(var v=0,g=new Uint8Array(r.length),b=g.length;v<b;++v)g[v]=r.charCodeAt(v);r=new p([g],{type:d})}function C(e){for(var t=e.split(/[:;,]/),i=t[1],s=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),a=s.length,n=0,o=new Uint8Array(a);n<a;++n)o[n]=s.charCodeAt(n);return new p([o],{type:i})}function $(e,t){if("download"in f)return f.href=e,f.setAttribute("download",u),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout(function(){f.click(),document.body.removeChild(f),!0===t&&setTimeout(function(){o.URL.revokeObjectURL(f.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,l)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var i=document.createElement("iframe");document.body.appendChild(i),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,l)),i.src=e,setTimeout(function(){document.body.removeChild(i)},333)}if(a=r instanceof p?r:new p([r],{type:d}),navigator.msSaveBlob)return navigator.msSaveBlob(a,u);if(o.URL)$(o.URL.createObjectURL(a),!0);else{if("string"==typeof a||a.constructor===m)try{return $("data:"+d+";base64,"+o.btoa(a))}catch(t){return $("data:"+d+","+encodeURIComponent(a))}(n=new FileReader).onload=function(e){$(this.result)},n.readAsDataURL(a)}return!0}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(n){"use strict";var a="dmUploader",i={auto:!0,queue:!0,dnd:!0,hookDocument:!0,multiple:!0,url:document.URL,method:"POST",extraData:{},headers:{},dataType:null,fieldName:"file",maxFileSize:0,allowedTypes:"*",extFilter:null,onInit:function(){},onComplete:function(){},onFallbackMode:function(){},onNewFile:function(){},onBeforeUpload:function(){},onUploadProgress:function(){},onUploadSuccess:function(){},onUploadCanceled:function(){},onUploadError:function(){},onUploadComplete:function(){},onFileTypeError:function(){},onFileSizeError:function(){},onFileExtError:function(){},onDragEnter:function(){},onDragLeave:function(){},onDocumentDragEnter:function(){},onDocumentDragLeave:function(){}},s=function(e,t){this.data=e,this.widget=t,this.jqXHR=null,this.status=0,this.id=Math.random().toString(36).substr(2)};s.prototype.upload=function(){var s=this;if(!s.canUpload())return s.widget.queueRunning&&1!==s.status&&s.widget.processQueue(),!1;var i=new FormData;i.append("upl",s.data,s.name);var e=s.widget.settings.extraData;return"function"==typeof e&&(e=e.call(s.widget.element,s.id)),n.each(e,function(e,t){i.append(e,t)}),s.status=1,s.widget.activeFiles++,s.widget.settings.onBeforeUpload.call(s.widget.element,s.id),s.jqXHR=n.ajax({url:s.widget.settings.url,type:s.widget.settings.method,dataType:s.widget.settings.dataType,data:i,headers:s.widget.settings.headers,cache:!1,contentType:!1,processData:!1,forceSync:!1,xhr:function(){return s.getXhr()},success:function(e){s.onSuccess(e)},error:function(e,t,i){s.onError(e,t,i)},complete:function(){s.onComplete()}}),!0},s.prototype.onSuccess=function(e){this.status=2,this.widget.settings.onUploadSuccess.call(this.widget.element,this.id,e)},s.prototype.onError=function(e,t,i){4!==this.status&&(this.status=3,this.widget.settings.onUploadError.call(this.widget.element,this.id,e,t,i),b4j_raiseEvent("page_parseevent",{eventname:this.widget.settings.parent.id+"_uploadfailed",eventparams:"status,message",status:""+t,message:""+i}))},s.prototype.onComplete=function(){this.widget.activeFiles--,4!==this.status&&this.widget.settings.onUploadComplete.call(this.widget.element,this.id),this.widget.queueRunning?this.widget.processQueue():this.widget.settings.queue&&0===this.widget.activeFiles&&(this.widget.settings.onComplete.call(this.element),b4j_raiseEvent("page_parseevent",{eventname:this.widget.settings.parent.id+"_uploaded",eventparams:""}))},s.prototype.getXhr=function(){var a=this,e=n.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(e){var t=0,i=e.loaded||e.position,s=e.total||e.totalSize;e.lengthComputable&&(t=Math.ceil(i/s*100)),a.widget.settings.onUploadProgress.call(a.widget.element,a.id,t)},!1),e},s.prototype.cancel=function(e){e=void 0!==e&&e;var t=this.status;return!!(1===t||e&&0===t)&&(this.status=4,this.widget.settings.onUploadCanceled.call(this.widget.element,this.id),1===t&&this.jqXHR.abort(),!0)},s.prototype.canUpload=function(){return 0===this.status||3===this.status};var o=function(e,t){return this.element=n(e),this.settings=n.extend({},i,t),this.checkSupport()?(this.init(),this):(n.error("Browser not supported by jQuery.dmUploader"),this.settings.onFallbackMode.call(this.element),!1)};o.prototype.checkSupport=function(){return void 0!==window.FormData&&!new RegExp("/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1.0|2.0|2.5|3.0))/").test(window.navigator.userAgent)},o.prototype.init=function(){var i=this;this.queue=[],this.queuePos=-1,this.queueRunning=!1,this.activeFiles=0,this.draggingOver=0,this.draggingOverDoc=0;var e=n("#"+i.settings.parent.id+"-input");return 0<e.length&&(e.prop("multiple",this.settings.multiple),e.on("change."+a,function(e){var t=e.target&&e.target.files;t&&t.length&&(i.addFiles(t),n(this).val(""))})),this.settings.dnd&&this.initDnD(),0!==e.length||this.settings.dnd?(this.settings.onInit.call(this.element),this):(n.error("Markup error found by jQuery.dmUploader"),null)},o.prototype.initDnD=function(){var s=this;s.element.on("drop."+a,function(e){e.preventDefault(),s.settings.parent.IsDragging=!1,n("#"+s.settings.parent.id+"-background").css("z-index",0),0<s.draggingOver&&(s.draggingOver=0,s.settings.onDragLeave.call(s.element));var t=e.originalEvent&&e.originalEvent.dataTransfer;if(t&&t.files&&t.files.length){var i=[];s.settings.multiple?i=t.files:i.push(t.files[0]),s.addFiles(i)}}),s.element.on("dragenter."+a,function(e){e.preventDefault(),0===s.draggingOver&&s.settings.onDragEnter.call(s.element),s.draggingOver++,s.settings.parent.IsDragging=!0}),s.element.on("dragleave."+a,function(e){e.preventDefault(),s.draggingOver--,s.settings.parent.IsDragging=!1,0===s.draggingOver&&s.settings.onDragLeave.call(s.element)}),s.settings.hookDocument&&(n(document).off("drop."+a).on("drop."+a,function(e){e.preventDefault(),0<s.draggingOverDoc&&(s.draggingOverDoc=0,s.settings.onDocumentDragLeave.call(s.element))}),n(document).off("dragenter."+a).on("dragenter."+a,function(e){e.preventDefault(),0===s.draggingOverDoc&&s.settings.onDocumentDragEnter.call(s.element),s.draggingOverDoc++}),n(document).off("dragleave."+a).on("dragleave."+a,function(e){e.preventDefault(),s.draggingOverDoc--,0===s.draggingOverDoc&&s.settings.onDocumentDragLeave.call(s.element)}),n(document).off("dragover."+a).on("dragover."+a,function(e){e.preventDefault()}))},o.prototype.releaseEvents=function(){this.element.off("."+a),n("#"+widget.settings.parent.id+"-input").off("."+a),this.settings.hookDocument&&n(document).off("."+a)},o.prototype.validateFile=function(e){if(0<this.settings.maxFileSize&&e.size>this.settings.maxFileSize)return this.settings.onFileSizeError.call(this.element,e),this.settings.parent.counter++,Materialize.toast('<span id="toastabmfilemanager'+this.settings.parent.counter+'" class="white-text">'+this.settings.parent.options.toastMax+" "+function(e,t){if(Math.abs(e)<1e3)return e+" B";for(var i=["kB","MB","GB","TB","PB","EB","ZB","YB"],s=-1;e/=1e3,++s,1e3<=Math.abs(e)&&s<i.length-1;);return e.toFixed(1)+" "+i[s]}(this.settings.maxFileSize)+"</span>",5e3,"rounded"),n("#toasterror"+this.settings.parent.counter).parent().css("background-color","#FF0000"),!1;if("*"!==this.settings.allowedTypes&&!e.type.match(this.settings.allowedTypes))return this.settings.onFileTypeError.call(this.element,e),this.settings.parent.counter++,Materialize.toast('<span id="toastabmfilemanager'+this.settings.parent.counter+'" class="white-text">'+this.settings.parent.options.toastType+"</span>",5e3,"rounded"),n("#toasterror"+this.settings.parent.counter).parent().css("background-color","#FF0000"),!1;if(null!==this.settings.extFilter){var t=e.name.toLowerCase().split(".").pop();if(n.inArray(t,this.settings.extFilter)<0)return this.settings.onFileExtError.call(this.element,e),this.settings.parent.counter++,Materialize.toast('<span id="toastabmfilemanager'+this.settings.parent.counter+'" class="white-text">'+this.settings.parent.options.toastExt+"</span>",5e3,"rounded"),n("#toasterror"+this.settings.parent.counter).parent().css("background-color","#FF0000"),!1}return new s(e,this)},o.prototype.addFiles=function(e){for(var t=0,i=0;i<e.length;i++){var s=this.validateFile(e[i]);s&&!1!==this.settings.onNewFile.call(this.element,s.id,s.data)&&(this.settings.auto&&!this.settings.queue&&s.upload(),this.queue.push(s),t++)}return 0===t||this.settings.auto&&this.settings.queue&&!this.queueRunning&&this.processQueue(),this},o.prototype.processQueue=function(){return this.queuePos++,this.queuePos>=this.queue.length?(0===this.activeFiles&&(this.settings.onComplete.call(this.element),b4j_raiseEvent("page_parseevent",{eventname:this.settings.parent.id+"_uploaded",eventparams:""})),this.queuePos=this.queue.length-1,this.queueRunning=!1):(this.queueRunning||b4j_raiseEvent("page_parseevent",{eventname:this.settings.parent.id+"_uploadstarted",eventparams:""}),this.queueRunning=!0,this.queue[this.queuePos].upload())},o.prototype.restartQueue=function(){this.queuePos=-1,this.queueRunning=!1,this.processQueue()},o.prototype.findById=function(e){for(var t=!1,i=0;i<this.queue.length;i++)if(this.queue[i].id===e){t=this.queue[i];break}return t},o.prototype.cancelAll=function(){var e=this.queueRunning;this.queueRunning=!1;for(var t=0;t<this.queue.length;t++)this.queue[t].cancel();e&&this.settings.onComplete.call(this.element)},o.prototype.startAll=function(){if(this.settings.queue)this.restartQueue();else for(var e=0;e<this.queue.length;e++)this.queue[e].upload()},o.prototype.methods={start:function(e){if(this.queueRunning)return!1;var t=!1;return void 0===e||(t=this.findById(e))?t?(4===t.status&&(t.status=0),t.upload()):(this.startAll(),!0):(n.error("File not found in jQuery.dmUploader"),!1)},cancel:function(e){var t=!1;return void 0===e||(t=this.findById(e))?t?t.cancel(!0):(this.cancelAll(),!0):(n.error("File not found in jQuery.dmUploader"),!1)},reset:function(){return this.cancelAll(),this.queue=[],this.queuePos=-1,!(this.activeFiles=0)},destroy:function(){this.cancelAll(),this.releaseEvents(),this.element.removeData(a)}},n.fn.dmUploader=function(t){var i=arguments;if("string"!=typeof t)return this.each(function(){n.data(this,a)||n.data(this,a,new o(this,t))});this.each(function(){var e=n.data(this,a);e instanceof o?"function"==typeof e.methods[t]?e.methods[t].apply(e,Array.prototype.slice.call(i,1)):n.error("Method "+t+" does not exist in jQuery.dmUploader"):n.error("Unknown plugin data found by jQuery.dmUploader")})}});