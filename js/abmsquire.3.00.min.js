function resizeFrame(a){var b=$(window).scrollTop();"true"==a.getAttribute("abmenabled")?$(a).contents().find("body").css("margin","8px"):$(a).contents().find("body").css("margin","0px"),a.style.height="auto",a.contentDocument&&(a.style.height=a.contentDocument.documentElement.scrollHeight+15+"px"),a.contentWindow&&(a.style.height=a.contentWindow.document.body.scrollHeight+15+"px"),$(window).scrollTop(b)}!function(a,b){"use strict";function F(a,b,c){this.root=this.currentNode=a,this.nodeType=b,this.filter=c}function I(a,b){for(var c=a.length;c--;)if(!b(a[c]))return!1;return!0}function J(a){return a.nodeType===d&&!!H[a.nodeName]}function K(a){return G.test(a.nodeName)}function L(a){var b=a.nodeType;return(b===d||b===g)&&!K(a)&&I(a.childNodes,K)}function M(a){var b=a.nodeType;return!(b!==d&&b!==g||K(a)||L(a))}function N(a,b){var c=new F(b,h,L);return c.currentNode=a,c}function O(a,b){return a=N(a,b).previousNode(),a!==b?a:null}function P(a,b){return a=N(a,b).nextNode(),a!==b?a:null}function Q(a,b){return!J(a)&&a.nodeType===b.nodeType&&a.nodeName===b.nodeName&&"A"!==a.nodeName&&a.className===b.className&&(!a.style&&!b.style||a.style.cssText===b.style.cssText)}function R(a,b,c){if(a.nodeName!==b)return!1;for(var d in c)if(a.getAttribute(d)!==c[d])return!1;return!0}function S(a,b,c,d){for(;a&&a!==b;){if(R(a,c,d))return a;a=a.parentNode}return null}function T(a,b){for(;b;){if(b===a)return!0;b=b.parentNode}return!1}function U(a,b){var e,f,g,h,c="";return a&&a!==b&&(c=U(a.parentNode,b),a.nodeType===d&&(c+=(c?">":"")+a.nodeName,(e=a.id)&&(c+="#"+e),(f=a.className.trim())&&(g=f.split(/\s\s*/),g.sort(),c+=".",c+=g.join(".")),(h=a.dir)&&(c+="[dir="+h+"]"))),c}function V(a){var b=a.nodeType;return b===d?a.childNodes.length:a.length||0}function W(a){var b=a.parentNode;return b&&b.removeChild(a),a}function X(a,b){var c=a.parentNode;c&&c.replaceChild(b,a)}function Y(a){for(var b=a.ownerDocument.createDocumentFragment(),c=a.childNodes,d=c?c.length:0;d--;)b.appendChild(a.firstChild);return b}function Z(a,c,d,e){var g,h,i,j,f=a.createElement(c);if(d instanceof Array&&(e=d,d=null),d)for(g in d)h=d[g],h!==b&&f.setAttribute(g,d[g]);if(e)for(i=0,j=e.length;i<j;i+=1)f.appendChild(e[i]);return f}function $(a,b){var f,g,c=a.ownerDocument,d=a;if(a===b&&((g=a.firstChild)&&"BR"!==g.nodeName||(f=Qa(c).createDefaultBlock(),g?a.replaceChild(f,g):a.appendChild(f),a=f,f=null)),a.nodeType===e)return d;if(K(a)){for(g=a.firstChild;z&&g&&g.nodeType===e&&!g.data;)a.removeChild(g),g=a.firstChild;g||(z?(f=c.createTextNode(n),Qa(c)._didAddZWS()):f=c.createTextNode(""))}else if(y){for(;a.nodeType!==e&&!J(a);){if(g=a.firstChild,!g){f=c.createTextNode("");break}a=g}a.nodeType===e?/^ +$/.test(a.data)&&(a.data=""):J(a)&&a.parentNode.insertBefore(c.createTextNode(""),a)}else if(!a.querySelector("BR"))for(f=Z(c,"BR");(g=a.lastElementChild)&&!K(g);)a=g;if(f)try{a.appendChild(f)}catch(b){Qa(c).didError({name:"Squire: fixCursor – "+b,message:"Parent: "+a.nodeName+"/"+a.innerHTML+" appendChild: "+f.nodeName})}return d}function _(a,b){var f,g,h,i,c=a.childNodes,d=a.ownerDocument,e=null,j=Qa(d)._config;for(f=0,g=c.length;f<g;f+=1)h=c[f],i="BR"===h.nodeName,!i&&K(h)?(e||(e=Z(d,j.blockTag,j.blockAttributes)),e.appendChild(h),f-=1,g-=1):(i||e)&&(e||(e=Z(d,j.blockTag,j.blockAttributes)),$(e,b),i?a.replaceChild(e,h):(a.insertBefore(e,h),f+=1,g+=1),e=null),M(h)&&_(h,b);return e&&a.appendChild($(e,b)),a}function aa(a,b,c,f){var h,i,j,g=a.nodeType;if(g===e&&a!==c)return aa(a.parentNode,a.splitText(b),c,f);if(g===d){if("number"==typeof b&&(b=b<a.childNodes.length?a.childNodes[b]:null),a===c)return b;for(h=a.parentNode,i=a.cloneNode(!1);b;)j=b.nextSibling,i.appendChild(b),b=j;return"OL"===a.nodeName&&S(a,f,"BLOCKQUOTE")&&(i.start=(+a.start||1)+a.childNodes.length-1),$(a,f),$(i,f),(j=a.nextSibling)?h.insertBefore(i,j):h.appendChild(i),aa(h,i,c,f)}return b}function ba(a,b){if(a.nodeType===d)for(var h,i,j,c=a.childNodes,f=c.length,g=[];f--;)if(h=c[f],i=f&&c[f-1],f&&K(h)&&Q(h,i)&&!H[h.nodeName])b.startContainer===h&&(b.startContainer=i,b.startOffset+=V(i)),b.endContainer===h&&(b.endContainer=i,b.endOffset+=V(i)),b.startContainer===a&&(b.startOffset>f?b.startOffset-=1:b.startOffset===f&&(b.startContainer=i,b.startOffset=V(i))),b.endContainer===a&&(b.endOffset>f?b.endOffset-=1:b.endOffset===f&&(b.endContainer=i,b.endOffset=V(i))),W(h),h.nodeType===e?i.appendData(h.data):g.push(Y(h));else if(h.nodeType===d){for(j=g.length;j--;)h.appendChild(g.pop());ba(h,b)}}function ca(a,b,c){for(var e,f,g,d=b;1===d.parentNode.childNodes.length;)d=d.parentNode;W(d),f=a.childNodes.length,e=a.lastChild,e&&"BR"===e.nodeName&&(a.removeChild(e),f-=1),g={startContainer:a,startOffset:f,endContainer:a,endOffset:f},a.appendChild(Y(b)),ba(a,g),c.setStart(g.startContainer,g.startOffset),c.collapse(!0),u&&(e=a.lastChild)&&"BR"===e.nodeName&&a.removeChild(e)}function da(a,b){var g,h,c=a.previousSibling,d=a.firstChild,e=a.ownerDocument,f="LI"===a.nodeName;if(!f||d&&/^[OU]L$/.test(d.nodeName))if(c&&Q(c,a)){if(!M(c)){if(!f)return;h=Z(e,"DIV"),h.appendChild(Y(c)),c.appendChild(h)}W(a),g=!M(a),c.appendChild(Y(a)),g&&_(c,b),d&&da(d,b)}else f&&(c=Z(e,"DIV"),a.insertBefore(c,d),$(c,b))}function Qa(a){for(var c,b=Pa.length;b--;)if(c=Pa[b],c._doc===a)return c;return null}function Ra(a,b){var c,d;a||(a={});for(c in b)d=b[c],a[c]=d&&d.constructor===Object?Ra(a[c],d):d;return a}function Sa(a,b){a.nodeType===f&&(a=a.body);var e,c=a.ownerDocument,d=c.defaultView;this._win=d,this._doc=c,this._root=a,this._events={},this._lastSelection=null,A&&this.addEventListener("beforedeactivate",this.getSelection),this._hasZWS=!1,this._lastAnchorNode=null,this._lastFocusNode=null,this._path="","onselectionchange"in c?this.addEventListener("selectionchange",this._updatePathOnEvent):(this.addEventListener("keyup",this._updatePathOnEvent),this.addEventListener("mouseup",this._updatePathOnEvent)),this._undoIndex=-1,this._undoStack=[],this._undoStackLength=0,this._isInUndoState=!1,this._ignoreChange=!1,this._ignoreAllChanges=!1,B?(e=new MutationObserver(this._docWasChanged.bind(this)),e.observe(a,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._mutation=e):this.addEventListener("keyup",this._keyUpDetectChange),this._restoreSelection=!1,this.addEventListener("blur",Wa),this.addEventListener("input",Xa),this.addEventListener("mousedown",Xa),this.addEventListener("touchstart",Xa),this.addEventListener("focus",Ya),this._awaitingPaste=!1,this.addEventListener(t?"beforecut":"cut",La),this.addEventListener("copy",Ma),this.addEventListener(t?"beforepaste":"paste",Na),this.addEventListener("drop",Oa),this.addEventListener(u?"keypress":"keydown",ua),this._keyHandlers=Object.create(ya),this.setConfig(b),t&&(d.Text.prototype.splitText=function(a){var b=this.ownerDocument.createTextNode(this.data.slice(a)),c=this.nextSibling,d=this.parentNode,e=this.length-a;return c?d.insertBefore(b,c):d.appendChild(b),e&&this.deleteData(a,e),b}),a.setAttribute("contenteditable","true");try{c.execCommand("enableObjectResizing",!1,"false"),c.execCommand("enableInlineTableEditing",!1,"false")}catch(a){}Pa.push(this),this.setHTML("")}function Wa(){this._restoreSelection=!0}function Xa(){this._restoreSelection=!1}function Ya(){this._restoreSelection&&this.setSelection(this._lastSelection)}function pb(a,b,c){var d,f;for(d=b.firstChild;d;d=f){if(f=d.nextSibling,K(d)){if(d.nodeType===e||"BR"===d.nodeName||"IMG"===d.nodeName){c.appendChild(d);continue}}else if(L(d)){c.appendChild(a.createDefaultBlock([pb(a,d,a._doc.createDocumentFragment())]));continue}pb(a,d,c)}return c}var c=2,d=1,e=3,f=9,g=11,h=1,i=4,j=0,k=1,l=2,m=3,n="​",o=a.defaultView,p=navigator.userAgent,q=/iP(?:ad|hone|od)/.test(p),r=/Mac OS X/.test(p),s=/Gecko\//.test(p),t=/Trident\/[456]\./.test(p),u=!!o.opera,v=/Edge\//.test(p),w=!v&&/WebKit\//.test(p),x=r?"meta-":"ctrl-",y=t||u,z=t||w,A=t,B="undefined"!=typeof MutationObserver,C=/[^ \t\r\n]/,D=Array.prototype.indexOf;Object.create||(Object.create=function(a){var b=function(){};return b.prototype=a,new b});var E={1:1,2:2,3:4,8:128,9:256,11:1024};F.prototype.nextNode=function(){for(var e,a=this.currentNode,b=this.root,c=this.nodeType,d=this.filter;;){for(e=a.firstChild;!e&&a&&a!==b;)e=a.nextSibling,e||(a=a.parentNode);if(!e)return null;if(E[e.nodeType]&c&&d(e))return this.currentNode=e,e;a=e}},F.prototype.previousNode=function(){for(var e,a=this.currentNode,b=this.root,c=this.nodeType,d=this.filter;;){if(a===b)return null;if(e=a.previousSibling)for(;a=e.lastChild;)e=a;else e=a.parentNode;if(!e)return null;if(E[e.nodeType]&c&&d(e))return this.currentNode=e,e;a=e}},F.prototype.previousPONode=function(){for(var e,a=this.currentNode,b=this.root,c=this.nodeType,d=this.filter;;){for(e=a.lastChild;!e&&a&&a!==b;)e=a.previousSibling,e||(a=a.parentNode);if(!e)return null;if(E[e.nodeType]&c&&d(e))return this.currentNode=e,e;a=e}};var G=/^(?:#text|A(?:BBR|CRONYM)?|B(?:R|D[IO])?|C(?:ITE|ODE)|D(?:ATA|EL|FN)|EM|FONT|HR|I(?:FRAME|MG|NPUT|NS)?|KBD|Q|R(?:P|T|UBY)|S(?:AMP|MALL|PAN|TR(?:IKE|ONG)|U[BP])?|U|VAR|WBR)$/,H={BR:1,HR:1,IFRAME:1,IMG:1,INPUT:1},ea=function(a,b){for(var c=a.childNodes;b&&a.nodeType===d;)a=c[b-1],c=a.childNodes,b=c.length;return a},fa=function(a,b){if(a.nodeType===d){var c=a.childNodes;if(b<c.length)a=c[b];else{for(;a&&!a.nextSibling;)a=a.parentNode;a&&(a=a.nextSibling)}}return a},ga=function(a,b){var h,i,j,k,c=a.startContainer,d=a.startOffset,f=a.endContainer,g=a.endOffset;c.nodeType===e?(h=c.parentNode,i=h.childNodes,d===c.length?(d=D.call(i,c)+1,a.collapsed&&(f=h,g=d)):(d&&(k=c.splitText(d),f===c?(g-=d,f=k):f===h&&(g+=1),c=k),d=D.call(i,c)),c=h):i=c.childNodes,j=i.length,d===j?c.appendChild(b):c.insertBefore(b,i[d]),c===f&&(g+=i.length-j),a.setStart(c,d),a.setEnd(f,g)},ha=function(a,b,c){var d=a.startContainer,f=a.startOffset,g=a.endContainer,h=a.endOffset;b||(b=a.commonAncestorContainer),b.nodeType===e&&(b=b.parentNode);for(var l,m,n,i=aa(g,h,b,c),j=aa(d,f,b,c),k=b.ownerDocument.createDocumentFragment();j!==i;)l=j.nextSibling,k.appendChild(j),j=l;return d=b,f=i?D.call(b.childNodes,i):b.childNodes.length,n=b.childNodes[f],m=n&&n.previousSibling,m&&m.nodeType===e&&n.nodeType===e&&(d=m,f=m.length,m.appendData(n.data),W(n)),a.setStart(d,f),a.collapse(!0),$(b,c),k},ia=function(a,b){ma(a);var c=a.startContainer,d=a.endContainer,e=(K(c)||L(c))&&(K(d)||L(d)),f=ha(a,null,b);la(a),c=na(a,b),e&&(d=oa(a,b),c&&d&&c!==d&&ca(c,d,a)),c&&$(c,b);var g=b.firstChild;return g&&"BR"!==g.nodeName?a.collapse(!1):($(b,b),a.selectNodeContents(b.firstChild)),f},ja=function(a,b,c){for(var e=!0,f=b.childNodes,g=f.length;g--;)if(!K(f[g])){e=!1;break}if(a.collapsed||ia(a,c),la(a),e)ga(a,b),a.collapse(!1);else{for(var p,q,r,s,t,h=a.startContainer,i=aa(h,a.startOffset,S(h.parentNode,c,"BLOCKQUOTE")||c,c),j=i.previousSibling,k=j,l=k.childNodes.length,m=i,n=0,o=i.parentNode;(p=k.lastChild)&&p.nodeType===d;){if("BR"===p.nodeName){l-=1;break}k=p,l=k.childNodes.length}for(;(p=m.firstChild)&&p.nodeType===d&&"BR"!==p.nodeName;)m=p;for(t=k.childNodes[l]||null;(p=b.firstChild)&&K(p);)k.insertBefore(p,t);for(;(p=b.lastChild)&&K(p);)m.insertBefore(p,m.firstChild),n+=1;for(q=b;q=P(q,c);)$(q,c);if(o.insertBefore(b,i),s=j.nextSibling,q=O(s,c),q&&!/\S/.test(q.textContent))do o=q.parentNode,o.removeChild(q),q=o;while(q&&!q.lastChild&&q!==c);if(j.parentNode||(j=s.previousSibling),k.parentNode||(k=j||s.parentNode,l=j?j.childNodes.length:0),M(s)&&da(s,c),r=i.previousSibling,q=L(i)?i:P(i,c),q&&!/\S/.test(q.textContent))do o=q.parentNode,o.removeChild(q),q=o;while(q&&!q.lastChild&&q!==c);i.parentNode||(i=r.nextSibling),n||(m=r,n=r.childNodes.length),i&&M(i)&&da(i,c),a.setStart(k,l),a.setEnd(m,n),la(a)}},ka=function(a,b,c){var d=b.ownerDocument.createRange();if(d.selectNode(b),c){var e=a.compareBoundaryPoints(m,d)>-1,f=a.compareBoundaryPoints(k,d)<1;return!e&&!f}var g=a.compareBoundaryPoints(j,d)<1,h=a.compareBoundaryPoints(l,d)>-1;return g&&h},la=function(a){for(var g,b=a.startContainer,c=a.startOffset,d=a.endContainer,f=a.endOffset;b.nodeType!==e&&(g=b.childNodes[c],g&&!J(g));)b=g,c=0;if(f)for(;d.nodeType!==e&&(g=d.childNodes[f-1],g&&!J(g));)d=g,f=V(d);else for(;d.nodeType!==e&&(g=d.firstChild,g&&!J(g));)d=g;a.collapsed?(a.setStart(d,f),a.setEnd(b,c)):(a.setStart(b,c),a.setEnd(d,f))},ma=function(a,b){var g,c=a.startContainer,d=a.startOffset,e=a.endContainer,f=a.endOffset;for(b||(b=a.commonAncestorContainer);c!==b&&!d;)g=c.parentNode,d=D.call(g.childNodes,c),c=g;for(;e!==b&&f===V(e);)g=e.parentNode,f=D.call(g.childNodes,e)+1,e=g;a.setStart(c,d),a.setEnd(e,f)},na=function(a,b){var d,c=a.startContainer;return K(c)?d=O(c,b):L(c)?d=c:(d=ea(c,a.startOffset),d=P(d,b)),d&&ka(a,d,!0)?d:null},oa=function(a,b){var d,e,c=a.endContainer;if(K(c))d=O(c,b);else if(L(c))d=c;else{if(d=fa(c,a.endOffset),!d||!T(b,d))for(d=b;e=d.lastChild;)d=e;d=O(d,b)}return d&&ka(a,d,!0)?d:null},pa=new F(null,i|h,function(a){return a.nodeType===e?C.test(a.data):"IMG"===a.nodeName}),qa=function(a,b){var f,c=a.startContainer,d=a.startOffset;if(pa.root=null,c.nodeType===e){if(d)return!1;f=c}else if(f=fa(c,d),f&&!T(b,f)&&(f=null),!f&&(f=ea(c,d),f.nodeType===e&&f.length))return!1;return pa.currentNode=f,pa.root=na(a,b),!pa.previousNode()},ra=function(a,b){var f,c=a.endContainer,d=a.endOffset;if(pa.root=null,c.nodeType===e){if(f=c.data.length,f&&d<f)return!1;pa.currentNode=c}else pa.currentNode=ea(c,d);return pa.root=oa(a,b),!pa.nextNode()},sa=function(a,b){var e,c=na(a,b),d=oa(a,b);c&&d&&(e=c.parentNode,a.setStart(e,D.call(e.childNodes,c)),e=d.parentNode,a.setEnd(e,D.call(e.childNodes,d)+1))},ta={8:"backspace",9:"tab",13:"enter",32:"space",33:"pageup",34:"pagedown",37:"left",39:"right",46:"delete",219:"[",221:"]"},ua=function(a){var b=a.keyCode,c=ta[b],d="",e=this.getSelection();a.defaultPrevented||(c||(c=String.fromCharCode(b).toLowerCase(),/^[A-Za-z0-9]$/.test(c)||(c="")),u&&46===a.which&&(c="."),111<b&&b<124&&(c="f"+(b-111)),"backspace"!==c&&"delete"!==c&&(a.altKey&&(d+="alt-"),a.ctrlKey&&(d+="ctrl-"),a.metaKey&&(d+="meta-")),a.shiftKey&&(d+="shift-"),c=d+c,this._keyHandlers[c]?this._keyHandlers[c](this,a,e):1!==c.length||e.collapsed||(this.saveUndoState(e),ia(e,this._root),this._ensureBottomLine(),this.setSelection(e),this._updatePath(e,!0)))},va=function(a){return function(b,c){c.preventDefault(),b[a]()}},wa=function(a,b){return b=b||null,function(c,d){d.preventDefault();var e=c.getSelection();c.hasFormat(a,null,e)?c.changeFormat(null,{tag:a},e):c.changeFormat({tag:a},b,e)}},xa=function(a,b){try{b||(b=a.getSelection());var d,c=b.startContainer;for(c.nodeType===e&&(c=c.parentNode),d=c;K(d)&&(!d.textContent||d.textContent===n);)c=d,d=c.parentNode;c!==d&&(b.setStart(d,D.call(d.childNodes,c)),b.collapse(!0),d.removeChild(c),L(d)||(d=O(d,a._root)),$(d,a._root),la(b)),c===a._root&&(c=c.firstChild)&&"BR"===c.nodeName&&W(c),a._ensureBottomLine(),a.setSelection(b),a._updatePath(b,!0)}catch(b){a.didError(b)}},ya={enter:function(a,b,c){var g,h,i,f=a._root;if(b.preventDefault(),a._recordUndoState(c),mb(c.startContainer,f,a),a._removeZWS(),a._getRangeAndRemoveBookmark(c),c.collapsed||ia(c,f),g=na(c,f),!g||/^T[HD]$/.test(g.nodeName))return ga(c,a.createElement("BR")),c.collapse(!1),a.setSelection(c),void a._updatePath(c,!0);if((h=S(g,f,"LI"))&&(g=h),!g.textContent){if(S(g,f,"UL")||S(g,f,"OL"))return a.modifyBlocks(kb,c);if(S(g,f,"BLOCKQUOTE"))return a.modifyBlocks(eb,c)}for(i=bb(a,g,c.startContainer,c.startOffset),Za(g),Ha(g),$(g,f);i.nodeType===d;){var k,j=i.firstChild;if("A"===i.nodeName&&(!i.textContent||i.textContent===n)){j=a._doc.createTextNode(""),X(i,j),i=j;break}for(;j&&j.nodeType===e&&!j.data&&(k=j.nextSibling,k&&"BR"!==k.nodeName);)W(j),j=k;if(!j||"BR"===j.nodeName||j.nodeType===e&&!u)break;i=j}c=a._createRange(i,0),a.setSelection(c),a._updatePath(c,!0)},backspace:function(a,b,c){var d=a._root;if(a._removeZWS(),a.saveUndoState(c),c.collapsed)if(qa(c,d)){b.preventDefault();var f,e=na(c,d);if(!e)return;if(_(e.parentNode,d),f=O(e,d)){if(!f.isContentEditable)return void W(f);for(ca(f,e,c),e=f.parentNode;e!==d&&!e.nextSibling;)e=e.parentNode;e!==d&&(e=e.nextSibling)&&da(e,d),a.setSelection(c)}else if(e){if(S(e,d,"UL")||S(e,d,"OL"))return a.modifyBlocks(kb,c);if(S(e,d,"BLOCKQUOTE"))return a.modifyBlocks(db,c);a.setSelection(c),a._updatePath(c,!0)}}else a.setSelection(c),setTimeout(function(){xa(a)},0);else b.preventDefault(),ia(c,d),xa(a,c)},delete:function(a,b,c){var f,g,h,i,j,k,e=a._root;if(a._removeZWS(),a.saveUndoState(c),c.collapsed)if(ra(c,e)){if(b.preventDefault(),f=na(c,e),!f)return;if(_(f.parentNode,e),g=P(f,e)){if(!g.isContentEditable)return void W(g);for(ca(f,g,c),g=f.parentNode;g!==e&&!g.nextSibling;)g=g.parentNode;g!==e&&(g=g.nextSibling)&&da(g,e),a.setSelection(c),a._updatePath(c,!0)}}else{if(h=c.cloneRange(),ma(c,a._root),i=c.endContainer,j=c.endOffset,i.nodeType===d&&(k=i.childNodes[j],k&&"IMG"===k.nodeName))return b.preventDefault(),W(k),la(c),void xa(a,c);a.setSelection(h),setTimeout(function(){xa(a)},0)}else b.preventDefault(),ia(c,e),xa(a,c)},tab:function(a,b,c){var e,f,d=a._root;if(a._removeZWS(),c.collapsed&&qa(c,d))for(e=na(c,d);f=e.parentNode;){if("UL"===f.nodeName||"OL"===f.nodeName){e.previousSibling&&(b.preventDefault(),a.modifyBlocks(jb,c));break}e=f}},"shift-tab":function(a,b,c){var e,d=a._root;a._removeZWS(),c.collapsed&&qa(c,d)&&(e=c.startContainer,(S(e,d,"UL")||S(e,d,"OL"))&&(b.preventDefault(),a.modifyBlocks(kb,c)))},space:function(a,b,c){var d,e;a._recordUndoState(c),mb(c.startContainer,a._root,a),a._getRangeAndRemoveBookmark(c),d=c.endContainer,e=d.parentNode,c.collapsed&&"A"===e.nodeName&&!d.nextSibling&&c.endOffset===V(d)&&c.setStartAfter(e),a.setSelection(c)},left:function(a){a._removeZWS()},right:function(a){a._removeZWS()}};r&&s&&(ya["meta-left"]=function(a,b){b.preventDefault();var c=Va(a);c&&c.modify&&c.modify("move","backward","lineboundary")},ya["meta-right"]=function(a,b){b.preventDefault();var c=Va(a);c&&c.modify&&c.modify("move","forward","lineboundary")}),r||(ya.pageup=function(a){a.moveCursorToStart()},ya.pagedown=function(a){a.moveCursorToEnd()}),ya[x+"b"]=wa("B"),ya[x+"i"]=wa("I"),ya[x+"u"]=wa("U"),ya[x+"shift-7"]=wa("S"),ya[x+"shift-5"]=wa("SUB",{tag:"SUP"}),ya[x+"shift-6"]=wa("SUP",{tag:"SUB"}),ya[x+"shift-8"]=va("makeUnorderedList"),ya[x+"shift-9"]=va("makeOrderedList"),ya[x+"["]=va("decreaseQuoteLevel"),ya[x+"]"]=va("increaseQuoteLevel"),ya[x+"y"]=va("redo"),ya[x+"z"]=va("undo"),ya[x+"shift-z"]=va("redo");var za={1:10,2:13,3:16,4:18,5:24,6:32,7:48},Aa={backgroundColor:{regexp:C,replace:function(a,b){return Z(a,"SPAN",{class:"highlight",style:"background-color:"+b})}},color:{regexp:C,replace:function(a,b){return Z(a,"SPAN",{class:"colour",style:"color:"+b})}},fontWeight:{regexp:/^bold/i,replace:function(a){return Z(a,"B")}},fontStyle:{regexp:/^italic/i,replace:function(a){return Z(a,"I")}},fontFamily:{regexp:C,replace:function(a,b){return Z(a,"SPAN",{class:"font",style:"font-family:"+b})}},fontSize:{regexp:C,replace:function(a,b){return Z(a,"SPAN",{class:"size",style:"font-size:"+b})}}},Ba=function(a){return function(b,c){var d=Z(b.ownerDocument,a);return c.replaceChild(d,b),d.appendChild(Y(b)),d}},Ca={SPAN:function(a,b){var e,f,g,h,i,j,c=a.style,d=a.ownerDocument;for(e in Aa)f=Aa[e],g=c[e],g&&f.regexp.test(g)&&(j=f.replace(d,g),h&&h.appendChild(j),h=j,i||(i=j));return i&&(h.appendChild(Y(a)),b.replaceChild(i,a)),h||a},STRONG:Ba("B"),EM:Ba("I"),STRIKE:Ba("S"),FONT:function(a,b){var g,h,i,j,k,c=a.face,d=a.size,e=a.color,f=a.ownerDocument;return c&&(g=Z(f,"SPAN",{class:"font",style:"font-family:"+c}),k=g,j=g),d&&(h=Z(f,"SPAN",{class:"size",style:"font-size:"+za[d]+"px"}),k||(k=h),j&&j.appendChild(h),j=h),e&&/^#?([\dA-F]{3}){1,2}$/i.test(e)&&("#"!==e.charAt(0)&&(e="#"+e),i=Z(f,"SPAN",{class:"colour",style:"color:"+e}),k||(k=i),j&&j.appendChild(i),j=i),k||(k=j=Z(f,"SPAN")),b.replaceChild(k,a),j.appendChild(Y(a)),j},TT:function(a,b){var c=Z(a.ownerDocument,"SPAN",{class:"font",style:'font-family:menlo,consolas,"courier new",monospace'});return b.replaceChild(c,a),c.appendChild(Y(a)),c}},Da=/^(?:A(?:DDRESS|RTICLE|SIDE|UDIO)|BLOCKQUOTE|CAPTION|D(?:[DLT]|IV)|F(?:IGURE|IGCAPTION|OOTER)|H[1-6]|HEADER|L(?:ABEL|EGEND|I)|O(?:L|UTPUT)|P(?:RE)?|SECTION|T(?:ABLE|BODY|D|FOOT|H|HEAD|R)|UL)$/,Ea=/^(?:HEAD|META|STYLE)/,Fa=new F(null,i|h,function(){return!0}),Ga=function a(b,c){var g,h,i,j,k,l,m,n,o,p,q,r,f=b.childNodes;for(g=b;K(g);)g=g.parentNode;for(Fa.root=g,h=0,i=f.length;h<i;h+=1)if(j=f[h],k=j.nodeName,l=j.nodeType,m=Ca[k],l===d){if(n=j.childNodes.length,m)j=m(j,b);else{if(Ea.test(k)){b.removeChild(j),h-=1,i-=1;continue}if(!Da.test(k)&&!K(j)){h-=1,i+=n-1,b.replaceChild(Y(j),j);continue}}n&&a(j,c||"PRE"===k)}else{if(l===e){if(q=j.data,o=!C.test(q.charAt(0)),p=!C.test(q.charAt(q.length-1)),c||!o&&!p)continue;if(o){for(Fa.currentNode=j;(r=Fa.previousPONode())&&(k=r.nodeName,!("IMG"===k||"#text"===k&&/\S/.test(r.data)));)if(!K(r)){r=null;break}q=q.replace(/^\s+/g,r?" ":"")}if(p){for(Fa.currentNode=j;(r=Fa.nextNode())&&!("IMG"===k||"#text"===k&&/\S/.test(r.data));)if(!K(r)){r=null;break}q=q.replace(/\s+$/g,r?" ":"")}if(q){j.data=q;continue}}b.removeChild(j),h-=1,i-=1}return b},Ha=function a(b){for(var g,c=b.childNodes,f=c.length;f--;)g=c[f],g.nodeType!==d||J(g)?g.nodeType!==e||g.data||b.removeChild(g):(a(g),K(g)&&!g.firstChild&&b.removeChild(g))},Ia=function(a){return a.nodeType===d?"BR"===a.nodeName:C.test(a.data)},Ja=function(a){for(var c,b=a.parentNode;K(b);)b=b.parentNode;return c=new F(b,h|i,Ia),c.currentNode=a,!!c.nextNode()},Ka=function(a,b){var f,g,h,c=a.querySelectorAll("BR"),d=[],e=c.length;for(f=0;f<e;f+=1)d[f]=Ja(c[f]);for(;e--;)g=c[e],h=g.parentNode,h&&(d[e]?K(h)||_(h,b):W(g))},La=function(a){var b=a.clipboardData,c=this.getSelection(),d=this.createElement("div"),e=this._root,f=this;this.saveUndoState(c),v||q||!b?setTimeout(function(){try{f._ensureBottomLine()}catch(a){f.didError(a)}},0):(ma(c,e),d.appendChild(ia(c,e)),b.setData("text/html",d.innerHTML),b.setData("text/plain",d.innerText||d.textContent),a.preventDefault()),this.setSelection(c)},Ma=function(a){var b=a.clipboardData,c=this.getSelection(),d=this.createElement("div");v||q||!b||(d.appendChild(c.cloneContents()),b.setData("text/html",d.innerHTML),b.setData("text/plain",d.innerText||d.textContent),a.preventDefault())},Na=function(a){var h,i,j,k,l,b=a.clipboardData,c=b&&b.items,d=!1,e=!1,f=null,g=this;if(!v&&c){for(a.preventDefault(),h=c.length;h--;){if(i=c[h],j=i.type,"text/html"===j)return void i.getAsString(function(a){g.insertHTML(a,!0)});"text/plain"===j&&(f=i),/^image\/.*/.test(j)&&(e=!0)}return void(e?(this.fireEvent("dragover",{dataTransfer:b,preventDefault:function(){d=!0}}),d&&this.fireEvent("drop",{dataTransfer:b})):f&&i.getAsString(function(a){g.insertPlainText(a,!0)}))}if(k=b&&b.types,!v&&k&&(D.call(k,"text/html")>-1||!s&&D.call(k,"text/plain")>-1&&D.call(k,"text/rtf")<0))return a.preventDefault(),void((l=b.getData("text/html"))?this.insertHTML(l,!0):((l=b.getData("text/plain"))||(l=b.getData("text/uri-list")))&&this.insertPlainText(l,!0));this._awaitingPaste=!0;var m=this._doc.body,n=this.getSelection(),o=n.startContainer,p=n.startOffset,q=n.endContainer,r=n.endOffset,t=this.createElement("DIV",{contenteditable:"true",style:"position:fixed; overflow:hidden; top:0; right:100%; width:1px; height:1px;"});m.appendChild(t),n.selectNodeContents(t),this.setSelection(n),setTimeout(function(){try{g._awaitingPaste=!1;for(var c,d,a="",b=t;t=b;)b=t.nextSibling,W(t),c=t.firstChild,c&&c===t.lastChild&&"DIV"===c.nodeName&&(t=c),a+=t.innerHTML;d=g._createRange(o,p,q,r),g.setSelection(d),a&&g.insertHTML(a,!0)}catch(a){g.didError(a)}},0)},Oa=function(a){for(var b=a.dataTransfer.types,c=b.length,d=!1,e=!1;c--;)switch(b[c]){case"text/plain":d=!0;break;case"text/html":e=!0;break;default:return}(e||d)&&this.saveUndoState()},Pa=[],Ta=Sa.prototype;Ta.setConfig=function(a){return a=Ra({blockTag:"DIV",blockAttributes:null,tagAttributes:{blockquote:null,ul:null,ol:null,li:null,a:null}},a),a.blockTag=a.blockTag.toUpperCase(),this._config=a,this},Ta.createElement=function(a,b,c){return Z(this._doc,a,b,c)},Ta.createDefaultBlock=function(a){var b=this._config;return $(this.createElement(b.blockTag,b.blockAttributes,a),this._root)},Ta.didError=function(a){console.log(a)},Ta.getDocument=function(){return this._doc},Ta.getRoot=function(){return this._root},Ta.modifyDocument=function(a){this._ignoreAllChanges=!0,this._mutation&&this._mutation.disconnect(),a(),this._ignoreAllChanges=!1,this._mutation&&this._mutation.observe(this._root,{childList:!0,attributes:!0,characterData:!0,subtree:!0})};var Ua={pathChange:1,select:1,input:1,undoStateChange:1};Ta.fireEvent=function(a,b){var d,e,c=this._events[a];if(c)for(b||(b={}),b.type!==a&&(b.type=a),c=c.slice(),d=c.length;d--;){e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(this,b)}catch(b){b.details="Squire: fireEvent error. Event type: "+a,this.didError(b)}}return this},Ta.destroy=function(){var c,a=Pa.length,b=this._events;for(c in b)this.removeEventListener(c);for(this._mutation&&this._mutation.disconnect();a--;)Pa[a]===this&&Pa.splice(a,1)},Ta.handleEvent=function(a){this.fireEvent(a.type,a)},Ta.addEventListener=function(a,b){var c=this._events[a],d=this._root;return b?(c||(c=this._events[a]=[],Ua[a]||("selectionchange"===a&&(d=this._doc),d.addEventListener(a,this,!0))),c.push(b),this):(this.didError({name:"Squire: addEventListener with null or undefined fn",message:"Event type: "+a}),this)},Ta.removeEventListener=function(a,b){var e,c=this._events[a],d=this._root;if(c){if(b)for(e=c.length;e--;)c[e]===b&&c.splice(e,1);else c.length=0;c.length||(delete this._events[a],Ua[a]||("selectionchange"===a&&(d=this._doc),d.removeEventListener(a,this,!0)))}return this},Ta._createRange=function(a,b,c,d){if(a instanceof this._win.Range)return a.cloneRange();var e=this._doc.createRange();return e.setStart(a,b),c?e.setEnd(c,d):e.setEnd(a,b),e},Ta.getCursorPosition=function(a){if(!a&&!(a=this.getSelection())||!a.getBoundingClientRect)return null;var c,d,b=a.getBoundingClientRect();return b&&!b.top&&(this._ignoreChange=!0,c=this._doc.createElement("SPAN"),c.textContent=n,ga(a,c),b=c.getBoundingClientRect(),d=c.parentNode,d.removeChild(c),ba(d,{startContainer:a.startContainer,endContainer:a.endContainer,startOffset:a.startOffset,endOffset:a.endOffset})),b},Ta._moveCursorTo=function(a){var b=this._root,c=this._createRange(b,a?0:b.childNodes.length);return la(c),this.setSelection(c),this},Ta.moveCursorToStart=function(){return this._moveCursorTo(!0)},Ta.moveCursorToEnd=function(){return this._moveCursorTo(!1)};var Va=function(a){return a._win.getSelection()||null};Ta.setSelection=function(a){if(a){this._restoreSelection=!1,this._lastSelection=a,q&&this._win.focus();var b=Va(this);b&&(b.removeAllRanges(),b.addRange(a))}return this},Ta.getSelection=function(){var c,d,e,a=Va(this),b=this._root;return a&&a.rangeCount&&(c=a.getRangeAt(0).cloneRange(),d=c.startContainer,e=c.endContainer,d&&J(d)&&c.setStartBefore(d),e&&J(e)&&c.setEndBefore(e)),c&&T(b,c.commonAncestorContainer)?this._lastSelection=c:c=this._lastSelection,c||(c=this._createRange(b.firstChild,0)),c},Ta.getSelectedText=function(){var k,a=this.getSelection(),b=new F(a.commonAncestorContainer,i|h,function(b){return ka(a,b,!0)}),c=a.startContainer,d=a.endContainer,f=b.currentNode=c,g="",j=!1;for(b.filter(f)||(f=b.nextNode());f;)f.nodeType===e?(k=f.data,k&&/\S/.test(k)&&(f===d&&(k=k.slice(0,a.endOffset)),f===c&&(k=k.slice(a.startOffset)),g+=k,j=!0)):("BR"===f.nodeName||j&&!K(f))&&(g+="\n",j=!1),f=b.nextNode();return g},Ta.getPath=function(){return this._path};var Za=function(a){for(var c,d,e,b=new F(a,i,function(){return!0},!1);d=b.nextNode();)for(;(e=d.data.indexOf(n))>-1;){if(1===d.length){do c=d.parentNode,c.removeChild(d),d=c,b.currentNode=c;while(K(d)&&!V(d));break}d.deleteData(e,1)}};Ta._didAddZWS=function(){this._hasZWS=!0},Ta._removeZWS=function(){this._hasZWS&&(Za(this._root),this._hasZWS=!1)},Ta._updatePath=function(a,b){var e,c=a.startContainer,d=a.endContainer;(b||c!==this._lastAnchorNode||d!==this._lastFocusNode)&&(this._lastAnchorNode=c,this._lastFocusNode=d,e=c&&d?c===d?U(d,this._root):"(selection)":"",this._path!==e&&(this._path=e,this.fireEvent("pathChange",{path:e}))),a.collapsed||this.fireEvent("select")},Ta._updatePathOnEvent=function(){this._updatePath(this.getSelection())},Ta.focus=function(){return this._root.focus(),this},Ta.blur=function(){return this._root.blur(),this};var $a="squire-selection-start",_a="squire-selection-end";Ta._saveRangeToBookmark=function(a){var e,b=this.createElement("INPUT",{id:$a,type:"hidden"}),d=this.createElement("INPUT",{id:_a,type:"hidden"});ga(a,b),a.collapse(!1),ga(a,d),b.compareDocumentPosition(d)&c&&(b.id=_a,d.id=$a,e=b,b=d,d=e),a.setStartAfter(b),a.setEndBefore(d)},Ta._getRangeAndRemoveBookmark=function(a){var b=this._root,c=b.querySelector("#"+$a),d=b.querySelector("#"+_a);if(c&&d){var h,f=c.parentNode,g=d.parentNode,i={startContainer:f,endContainer:g,startOffset:D.call(f.childNodes,c),endOffset:D.call(g.childNodes,d)};f===g&&(i.endOffset-=1),W(c),W(d),ba(f,i),f!==g&&ba(g,i),a||(a=this._doc.createRange()),a.setStart(i.startContainer,i.startOffset),a.setEnd(i.endContainer,i.endOffset),h=a.collapsed,h&&(f=a.startContainer,f.nodeType===e&&(g=f.childNodes[a.startOffset],g&&g.nodeType===e||(g=f.childNodes[a.startOffset-1]),g&&g.nodeType===e&&(a.setStart(g,0),a.collapse(!0))))}return a||null},Ta._keyUpDetectChange=function(a){var b=a.keyCode;a.ctrlKey||a.metaKey||a.altKey||!(b<16||b>20)||!(b<33||b>45)||this._docWasChanged()},Ta._docWasChanged=function(){if(!this._ignoreAllChanges){if(B&&this._ignoreChange)return void(this._ignoreChange=!1);this._isInUndoState&&(this._isInUndoState=!1,this.fireEvent("undoStateChange",{canUndo:!0,canRedo:!1})),this.fireEvent("input")}},Ta._recordUndoState=function(a){if(!this._isInUndoState){var b=this._undoIndex+=1,c=this._undoStack;b<this._undoStackLength&&(c.length=this._undoStackLength=b),a&&this._saveRangeToBookmark(a),c[b]=this._getHTML(),this._undoStackLength+=1,this._isInUndoState=!0}},Ta.saveUndoState=function(a){return a===b&&(a=this.getSelection()),this._isInUndoState||(this._recordUndoState(a),this._getRangeAndRemoveBookmark(a)),this},Ta.undo=function(){if(0!==this._undoIndex||!this._isInUndoState){this._recordUndoState(this.getSelection()),this._undoIndex-=1,this._setHTML(this._undoStack[this._undoIndex]);var a=this._getRangeAndRemoveBookmark();a&&this.setSelection(a),this._isInUndoState=!0,this.fireEvent("undoStateChange",{canUndo:0!==this._undoIndex,canRedo:!0}),this.fireEvent("input")}return this},Ta.redo=function(){var a=this._undoIndex,b=this._undoStackLength;if(a+1<b&&this._isInUndoState){this._undoIndex+=1,this._setHTML(this._undoStack[this._undoIndex]);var c=this._getRangeAndRemoveBookmark();c&&this.setSelection(c),this.fireEvent("undoStateChange",{canUndo:!0,canRedo:a+2<b}),this.fireEvent("input")}return this},Ta.hasFormat=function(a,b,c){if(a=a.toUpperCase(),b||(b={}),!c&&!(c=this.getSelection()))return!1;!c.collapsed&&c.startContainer.nodeType===e&&c.startOffset===c.startContainer.length&&c.startContainer.nextSibling&&c.setStartBefore(c.startContainer.nextSibling),!c.collapsed&&c.endContainer.nodeType===e&&0===c.endOffset&&c.endContainer.previousSibling&&c.setEndAfter(c.endContainer.previousSibling);var g,h,d=this._root,f=c.commonAncestorContainer;if(S(f,d,a,b))return!0;if(f.nodeType===e)return!1;g=new F(f,i,function(a){return ka(c,a,!0)},!1);for(var j=!1;h=g.nextNode();){if(!S(h,d,a,b))return!1;j=!0}return j},Ta.getFontInfo=function(a){var f,g,h,c={color:b,backgroundColor:b,family:b,size:b},d=0;if(!a&&!(a=this.getSelection()))return c;if(f=a.commonAncestorContainer,a.collapsed||f.nodeType===e)for(f.nodeType===e&&(f=f.parentNode);d<4&&f;)(g=f.style)&&(!c.color&&(h=g.color)&&(c.color=h,d+=1),!c.backgroundColor&&(h=g.backgroundColor)&&(c.backgroundColor=h,d+=1),!c.family&&(h=g.fontFamily)&&(c.family=h,d+=1),!c.size&&(h=g.fontSize)&&(c.size=h,d+=1)),f=f.parentNode;return c},Ta._addFormat=function(a,b,c){var f,g,j,k,l,m,n,o,d=this._root;if(c.collapsed)f=$(this.createElement(a,b),d),
ga(c,f),c.setStart(f.firstChild,f.firstChild.length),c.collapse(!0);else{if(g=new F(c.commonAncestorContainer,i|h,function(a){return(a.nodeType===e||"BR"===a.nodeName||"IMG"===a.nodeName)&&ka(c,a,!0)},!1),j=c.startContainer,l=c.startOffset,k=c.endContainer,m=c.endOffset,g.currentNode=j,g.filter(j)||(j=g.nextNode(),l=0),!j)return c;do n=g.currentNode,o=!S(n,d,a,b),o&&(n===k&&n.length>m&&n.splitText(m),n===j&&l&&(n=n.splitText(l),k===j&&(k=n,m-=l),j=n,l=0),f=this.createElement(a,b),X(n,f),f.appendChild(n));while(g.nextNode());k.nodeType!==e&&(n.nodeType===e?(k=n,m=n.length):(k=n.parentNode,m=1)),c=this._createRange(j,l,k,m)}return c},Ta._removeFormat=function(a,b,c,d){this._saveRangeToBookmark(c);var g,f=this._doc;c.collapsed&&(z?(g=f.createTextNode(n),this._didAddZWS()):g=f.createTextNode(""),ga(c,g));for(var h=c.commonAncestorContainer;K(h);)h=h.parentNode;var i=c.startContainer,j=c.startOffset,k=c.endContainer,l=c.endOffset,m=[],o=function(a,b){if(!ka(c,a,!1)){var f,g,d=a.nodeType===e;if(!ka(c,a,!0))return void("INPUT"===a.nodeName||d&&!a.data||m.push([b,a]));if(d)a===k&&l!==a.length&&m.push([b,a.splitText(l)]),a===i&&j&&(a.splitText(j),m.push([b,a]));else for(f=a.firstChild;f;f=g)g=f.nextSibling,o(f,b)}},p=Array.prototype.filter.call(h.getElementsByTagName(a),function(d){return ka(c,d,!0)&&R(d,a,b)});d||p.forEach(function(a){o(a,a)}),m.forEach(function(a){var b=a[0].cloneNode(!1),c=a[1];X(c,b),b.appendChild(c)}),p.forEach(function(a){X(a,Y(a))}),this._getRangeAndRemoveBookmark(c),g&&c.collapse(!1);var q={startContainer:c.startContainer,startOffset:c.startOffset,endContainer:c.endContainer,endOffset:c.endOffset};return ba(h,q),c.setStart(q.startContainer,q.startOffset),c.setEnd(q.endContainer,q.endOffset),c},Ta.changeFormat=function(a,b,c,d){if(c||(c=this.getSelection()))return this.saveUndoState(c),b&&(c=this._removeFormat(b.tag.toUpperCase(),b.attributes||{},c,d)),a&&(c=this._addFormat(a.tag.toUpperCase(),a.attributes||{},c)),this.setSelection(c),this._updatePath(c,!0),B||this._docWasChanged(),this};var ab={DT:"DD",DD:"DT",LI:"LI"},bb=function(a,b,c,d){var e=ab[b.nodeName],f=null,g=aa(c,d,b.parentNode,a._root),h=a._config;return e||(e=h.blockTag,f=h.blockAttributes),R(g,e,f)||(b=Z(g.ownerDocument,e,f),g.dir&&(b.dir=g.dir),X(g,b),b.appendChild(Y(g)),g=b),g};Ta.forEachBlock=function(a,b,c){if(!c&&!(c=this.getSelection()))return this;b&&this.saveUndoState(c);var d=this._root,e=na(c,d),f=oa(c,d);if(e&&f)do if(a(e)||e===f)break;while(e=P(e,d));return b&&(this.setSelection(c),this._updatePath(c,!0),B||this._docWasChanged()),this},Ta.modifyBlocks=function(a,b){if(!b&&!(b=this.getSelection()))return this;this._isInUndoState?this._saveRangeToBookmark(b):this._recordUndoState(b);var d,c=this._root;return sa(b,c),ma(b,c),d=ha(b,c,c),ga(b,a.call(this,d)),b.endOffset<b.endContainer.childNodes.length&&da(b.endContainer.childNodes[b.endOffset],c),da(b.startContainer.childNodes[b.startOffset],c),this._getRangeAndRemoveBookmark(b),this.setSelection(b),this._updatePath(b,!0),B||this._docWasChanged(),this};var cb=function(a){return this.createElement("BLOCKQUOTE",this._config.tagAttributes.blockquote,[a])},db=function(a){var b=this._root,c=a.querySelectorAll("blockquote");return Array.prototype.filter.call(c,function(a){return!S(a.parentNode,b,"BLOCKQUOTE")}).forEach(function(a){X(a,Y(a))}),a},eb=function(){return this.createDefaultBlock([this.createElement("INPUT",{id:$a,type:"hidden"}),this.createElement("INPUT",{id:_a,type:"hidden"})])},fb=function(a,b,c){for(var e,f,g,h,d=N(b,a._root),i=a._config.tagAttributes,j=i[c.toLowerCase()],k=i.li;e=d.nextNode();)f=e.parentNode.nodeName,"LI"!==f?(h=a.createElement("LI",k),e.dir&&(h.dir=e.dir),(g=e.previousSibling)&&g.nodeName===c?g.appendChild(h):X(e,a.createElement(c,j,[h])),h.appendChild(e)):(e=e.parentNode.parentNode,f=e.nodeName,f!==c&&/^[OU]L$/.test(f)&&X(e,a.createElement(c,j,[Y(e)])))},gb=function(a){return fb(this,a,"UL"),a},hb=function(a){return fb(this,a,"OL"),a},ib=function(a){var c,d,e,f,g,h,i,b=a.querySelectorAll("UL, OL");for(c=0,d=b.length;c<d;c+=1){for(f=b[c],g=Y(f),h=g.childNodes,e=h.length;e--;)i=h[e],X(i,Y(i));_(g,this._root),X(f,g)}return a},jb=function(a){var c,d,e,f,g,j,b=a.querySelectorAll("LI"),h=this._config.tagAttributes,i=h.li;for(c=0,d=b.length;c<d;c+=1)e=b[c],M(e.firstChild)||(f=e.parentNode.nodeName,g=e.previousSibling,g&&(g=g.lastChild)&&g.nodeName===f||(j=h[f.toLowerCase()],X(e,this.createElement("LI",i,[g=this.createElement(f,j)]))),g.appendChild(e));return a},kb=function(a){var b=this._root,c=a.querySelectorAll("LI");return Array.prototype.filter.call(c,function(a){return!M(a.firstChild)}).forEach(function(c){var h,d=c.parentNode,e=d.parentNode,f=c.firstChild,g=f;for(c.previousSibling&&(d=aa(d,c,e,b));g&&(h=g.nextSibling,!M(g));)e.insertBefore(g,d),g=h;for("LI"===e.nodeName&&f.previousSibling&&aa(e,f,e.parentNode,b);c!==a&&!c.childNodes.length;)d=c.parentNode,d.removeChild(c),c=d},this),_(a,b),a};Ta._ensureBottomLine=function(){var a=this._root,b=a.lastElementChild;b&&b.nodeName===this._config.blockTag&&L(b)||a.appendChild(this.createDefaultBlock())},Ta.setKeyHandler=function(a,b){return this._keyHandlers[a]=b,this},Ta._getHTML=function(){return this._root.innerHTML},Ta._setHTML=function(a){var b=this._root,c=b;c.innerHTML=a;do $(c,b);while(c=P(c,b));this._ignoreChange=!0},Ta.getHTML=function(a){var c,d,e,f,g,h,b=[];if(a&&(h=this.getSelection())&&this._saveRangeToBookmark(h),y)for(c=this._root,d=c;d=P(d,c);)d.textContent||d.querySelector("BR")||(e=this.createElement("BR"),d.appendChild(e),b.push(e));if(f=this._getHTML().replace(/\u200B/g,""),y)for(g=b.length;g--;)W(b[g]);return h&&this._getRangeAndRemoveBookmark(h),f},Ta.setHTML=function(a){var e,b=this._doc.createDocumentFragment(),c=this.createElement("DIV"),d=this._root;c.innerHTML=a,b.appendChild(Y(c)),Ga(b),Ka(b,d),_(b,d);for(var f=b;f=P(f,d);)$(f,d);for(this._ignoreChange=!0;e=d.lastChild;)d.removeChild(e);d.appendChild(b),$(d,d),this._undoIndex=-1,this._undoStack.length=0,this._undoStackLength=0,this._isInUndoState=!1;var g=this._getRangeAndRemoveBookmark()||this._createRange(d.firstChild,0);return this.saveUndoState(g),this._lastSelection=g,this._updatePath(g,!0),this},Ta.insertElement=function(a,b){if(b||(b=this.getSelection()),b.collapse(!0),K(a))ga(b,a),b.setStartAfter(a);else{for(var e,f,c=this._root,d=na(b,c)||c;d!==c&&!d.nextSibling;)d=d.parentNode;d!==c&&(e=d.parentNode,f=aa(e,d.nextSibling,c,c)),f?c.insertBefore(a,f):(c.appendChild(a),f=this.createDefaultBlock(),c.appendChild(f)),b.setStart(f,0),b.setEnd(f,0),la(b)}return this.focus(),this.setSelection(b),this._updatePath(b),B||this._docWasChanged(),this},Ta.insertImage=function(a,b){var c=this.createElement("IMG",Ra({src:a},b));return this.insertElement(c),c};var lb=/\b((?:(?:ht|f)tps?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,}\/)(?:[^\s()<>]+|\([^\s()<>]+\))+(?:\((?:[^\s()<>]+|(?:\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))|([\w\-.%+]+@(?:[\w\-]+\.)+[A-Z]{2,}\b)/i,mb=function(a,b,c){for(var g,h,j,k,l,m,n,d=a.ownerDocument,e=new F(a,i,function(a){return!S(a,b,"A")},!1),f=c._config.tagAttributes.a;g=e.nextNode();)for(h=g.data,j=g.parentNode;k=lb.exec(h);)l=k.index,m=l+k[0].length,l&&(n=d.createTextNode(h.slice(0,l)),j.insertBefore(n,g)),n=c.createElement("A",Ra({href:k[1]?/^(?:ht|f)tps?:/.test(k[1])?k[1]:"http://"+k[1]:"mailto:"+k[2]},f)),n.textContent=h.slice(l,m),j.insertBefore(n,g),g.data=h=h.slice(m)};Ta.insertHTML=function(a,b){var f,g,h,i,j,c=this.getSelection(),d=this._doc.createDocumentFragment(),e=this.createElement("DIV");b&&(f=a.indexOf("<!--StartFragment-->"),g=a.lastIndexOf("<!--EndFragment-->"),f>-1&&g>-1&&(a=a.slice(f+20,g))),e.innerHTML=a,d.appendChild(Y(e)),this.saveUndoState(c);try{for(h=this._root,i=d,j={fragment:d,preventDefault:function(){this.defaultPrevented=!0},defaultPrevented:!1},mb(d,d,this),Ga(d),Ka(d,null),Ha(d),d.normalize();i=P(i,d);)$(i,null);b&&this.fireEvent("willPaste",j),j.defaultPrevented||(ja(c,j.fragment,h),B||this._docWasChanged(),c.collapse(!1),this._ensureBottomLine()),this.setSelection(c),this._updatePath(c,!0)}catch(a){this.didError(a)}return this};var nb=function(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;")};Ta.insertPlainText=function(a,b){var i,j,k,l,c=a.split("\n"),d=this._config,e=d.blockTag,f=d.blockAttributes,g="</"+e+">",h="<"+e;for(i in f)h+=" "+i+'="'+nb(f[i])+'"';for(h+=">",j=0,k=c.length;j<k;j+=1)l=c[j],l=nb(l).replace(/ (?= )/g,"&nbsp;"),j&&j+1<k&&(l=h+(l||"<BR>")+g),c[j]=l;return this.insertHTML(c.join(""),b)};var ob=function(a,b,c){return function(){return this[a](b,c),this.focus()}};Ta.addStyles=function(a){if(a){var b=this._doc.documentElement.firstChild,c=this.createElement("STYLE",{type:"text/css"});c.appendChild(this._doc.createTextNode(a)),b.appendChild(c)}return this},Ta.bold=ob("changeFormat",{tag:"B"}),Ta.italic=ob("changeFormat",{tag:"I"}),Ta.underline=ob("changeFormat",{tag:"U"}),Ta.strikethrough=ob("changeFormat",{tag:"S"}),Ta.subscript=ob("changeFormat",{tag:"SUB"},{tag:"SUP"}),Ta.superscript=ob("changeFormat",{tag:"SUP"},{tag:"SUB"}),Ta.removeBold=ob("changeFormat",null,{tag:"B"}),Ta.removeItalic=ob("changeFormat",null,{tag:"I"}),Ta.removeUnderline=ob("changeFormat",null,{tag:"U"}),Ta.removeStrikethrough=ob("changeFormat",null,{tag:"S"}),Ta.removeSubscript=ob("changeFormat",null,{tag:"SUB"}),Ta.removeSuperscript=ob("changeFormat",null,{tag:"SUP"}),Ta.makeLink=function(a,b){var c=this.getSelection();if(c.collapsed){var d=a.indexOf(":")+1;if(d)for(;"/"===a[d];)d+=1;ga(c,this._doc.createTextNode(a.slice(d)))}return b||(b={}),Ra(b,this._config.tagAttributes.a),b.href=a,this.changeFormat({tag:"A",attributes:b},{tag:"A"},c),this.focus()},Ta.removeLink=function(){return this.changeFormat(null,{tag:"A"},this.getSelection(),!0),this.focus()},Ta.setFontFace=function(a){return this.changeFormat({tag:"SPAN",attributes:{class:"font",style:"font-family: "+a+", sans-serif;"}},{tag:"SPAN",attributes:{class:"font"}}),this.focus()},Ta.setFontSize=function(a){return this.changeFormat({tag:"SPAN",attributes:{class:"size",style:"font-size: "+("number"==typeof a?a+"px":a)}},{tag:"SPAN",attributes:{class:"size"}}),this.focus()},Ta.setTextColour=function(a){return this.changeFormat({tag:"SPAN",attributes:{class:"colour",style:"color:"+a}},{tag:"SPAN",attributes:{class:"colour"}}),this.focus()},Ta.setHighlightColour=function(a){return this.changeFormat({tag:"SPAN",attributes:{class:"highlight",style:"background-color:"+a}},{tag:"SPAN",attributes:{class:"highlight"}}),this.focus()},Ta.setTextAlignment=function(a){return this.forEachBlock(function(b){b.className=(b.className.split(/\s+/).filter(function(a){return!/align/.test(a)}).join(" ")+" align-"+a).trim(),b.style.textAlign=a},!0),this.focus()},Ta.setTextDirection=function(a){return this.forEachBlock(function(b){b.dir=a},!0),this.focus()},Ta.removeAllFormatting=function(a){if(!a&&!(a=this.getSelection())||a.collapsed)return this;for(var b=this._root,c=a.commonAncestorContainer;c&&!L(c);)c=c.parentNode;if(c||(sa(a,b),c=b),c.nodeType===e)return this;this.saveUndoState(a),ma(a,c);for(var n,o,p,d=c.ownerDocument,f=a.startContainer,g=a.startOffset,h=a.endContainer,i=a.endOffset,j=d.createDocumentFragment(),k=d.createDocumentFragment(),l=aa(h,i,c,b),m=aa(f,g,c,b);m!==l;)n=m.nextSibling,j.appendChild(m),m=n;return pb(this,j,k),k.normalize(),m=k.firstChild,n=k.lastChild,p=c.childNodes,m?(c.insertBefore(k,l),g=D.call(p,m),i=D.call(p,n)+1):(g=D.call(p,l),i=g),o={startContainer:c,startOffset:g,endContainer:c,endOffset:i},ba(c,o),a.setStart(o.startContainer,o.startOffset),a.setEnd(o.endContainer,o.endOffset),la(a),this.setSelection(a),this._updatePath(a,!0),this.focus()},Ta.increaseQuoteLevel=ob("modifyBlocks",cb),Ta.decreaseQuoteLevel=ob("modifyBlocks",db),Ta.makeUnorderedList=ob("modifyBlocks",gb),Ta.makeOrderedList=ob("modifyBlocks",hb),Ta.removeList=ob("modifyBlocks",ib),Ta.increaseListLevel=ob("modifyBlocks",jb),Ta.decreaseListLevel=ob("modifyBlocks",kb),"object"==typeof exports?module.exports=Sa:"function"==typeof define&&define.amd?define(function(){return Sa}):(o.Squire=Sa,top!==o&&"true"===a.documentElement.getAttribute("data-squireinit")&&(o.editor=new Sa(a),o.onEditorLoad&&(o.onEditorLoad(o.editor),o.onEditorLoad=null)))}(document),$(document).ready(function(){Squire.prototype.testPresenceinSelection=function(a,b,c,d){var e=this.getPath(),f=d.test(e)|this.hasFormat(c);return!(a!=b||!f)},Squire.prototype.checkPresenceinSelection=function(a,b,c){var d=this.getPath(),e=c.test(d)|this.hasFormat(b);return 1==e},SquireUI=function(a){"undefined"==typeof a.buildPath&&(a.buildPath="build/");var b;if(a.replace)b=$(a.replace).parent(),$(a.replace).remove();else{if(!a.div)throw new Error("No element was defined for the editor to inject to.");b=$(a.div)}var d=document.createElement("iframe");d.id=a.id+"-iframe",d.name=a.id+"-iframe",d.setAttribute("abm-menu",a.id+"-menu"),d.setAttribute("scrolling","no"),d.setAttribute("frameborder","0"),d.setAttribute("onload","resizeFrame(this)"),d.setAttribute("abmenabled",""+a.isEnabled),d.setAttribute("abmtoolbar",""+a.hasToolbar),d.className="abmiframe";var e=document.createElement("div");return e.id=a.id+"-div",e.className="Squire-UI input-field no-print",$(e).load(a.buildPath+"Squire-UI.html",function(){$(e).find("#menu").attr("id",a.id+"-menu"),$(e).find("#"+a.id+"-menu").addClass("menu"+a.theme),a.hasToolbar&&a.isEnabled||$(e).find("#"+a.id+"-menu").addClass("hide"),$(e).find("[parent-menu='menu']").each(function(){$(this).attr("parent-menu",a.id+"-menu"),$(this).addClass("item-"+a.id)}),$(e).find("#abm-bold").attr("id",a.id+"-abm-bold"),$(e).find("#abm-italic").attr("id",a.id+"-abm-italic"),$(e).find("#abm-underline").attr("id",a.id+"-abm-underline"),$(e).find("#abm-link").attr("id",a.id+"-abm-link"),$(e).find("#abm-ordered").attr("id",a.id+"-abm-ordered"),$(e).find("#abm-quote").attr("id",a.id+"-abm-quote"),$(e).find("#makeLink").attr("id","makeLink-"+a.id),$(e).find("#insertImage").attr("id","insertImage-"+a.id),$(e).find("#insertFont").attr("id","insertFont-"+a.id),$(e).find("#drop-link").attr("id","drop-link-"+a.id),$(e).find("#drop-link-title").attr("id","drop-link-title-"+a.id),$(e).find("#drop-link-i").attr("id","drop-link-i-"+a.id),$(e).find("#drop-link-btn").attr("id","drop-link-btn-"+a.id),$(e).find("#drop-font").attr("id","drop-font-"+a.id),$(e).find("#drop-font-title").attr("id","drop-font-title-"+a.id),$(e).find("#drop-font-i").attr("id","drop-font-i-"+a.id),$(e).find("#drop-font-btn").attr("id","drop-font-btn-"+a.id),$(e).find("#drop-image").attr("id","drop-image-"+a.id),$(e).find("#drop-image-title").attr("id","drop-image-title-"+a.id),$(e).find("#drop-image-i").attr("id","drop-image-i-"+a.id),$(e).find("#drop-image-btn").attr("id","drop-image-btn-"+a.id),$(e).find("#url").attr("id","url-"+a.id),$(e).find("#imageUrl").attr("id","imageUrl-"+a.id),$(e).find("#font").attr("id","font-"+a.id),$(e).find("#drop-link-i-"+a.id).addClass("quit-"+a.id),$(e).find("#drop-image-i-"+a.id).addClass("quit-"+a.id),$(e).find("#drop-font-i-"+a.id).addClass("quit-"+a.id),$(e).find("#drop-link-btn-"+a.id).addClass("submitLink-"+a.id),$(e).find("#drop-image-btn-"+a.id).addClass("sumbitImageURL-"+a.id),$(e).find("#drop-font-btn-"+a.id).addClass("sumbitFont-"+a.id),$(e).find("#drop-link-title-"+a.id).addClass(a.dropboxTitleColor),$(e).find("#drop-image-title-"+a.id).addClass(a.dropboxTitleColor),$(e).find("#drop-font-title-"+a.id).addClass(a.dropboxTitleColor),$(e).find("#drop-link-i-"+a.id).addClass(a.dropboxTitleColor),$(e).find("#drop-image-i-"+a.id).addClass(a.dropboxTitleColor),$(e).find("#drop-font-i-"+a.id).addClass(a.dropboxTitleColor),$(e).find("#drop-link-title-"+a.id).text(a.dropboxLinkTitle),$(e).find("#drop-image-title-"+a.id).text(a.dropboxImageTitle),$(e).find("#drop-font-title-"+a.id).text(a.dropboxFontSizeTitle),$(e).find("#url-"+a.id).css({"border-bottom":"1px solid "+a.dropboxLineColor,"box-shadow":"0 1px 0 0 "+a.dropboxLineColor}),$(e).find("#imageUrl-"+a.id).css({"border-bottom":"1px solid "+a.dropboxLineColor,"box-shadow":"0 1px 0 0 "+a.dropboxLineColor}),$(e).find("#font-"+a.id).css({"border-bottom":"1px solid "+a.dropboxLineColor,"box-shadow":"0 1px 0 0 "+a.dropboxLineColor}),$(e).find("#url-"+a.id).addClass(a.dropboxTextColor),$(e).find("#imageUrl-"+a.id).addClass(a.dropboxTextColor),$(e).find("#font-"+a.id).addClass(a.dropboxTextColor),$(e).find("#drop-link-btn-"+a.id).addClass(a.dropboxButtonBackColor),$(e).find("#drop-link-btn-"+a.id).addClass(a.dropboxButtonForeColor),$(e).find("#drop-image-btn-"+a.id).addClass(a.dropboxButtonBackColor),$(e).find("#drop-image-btn-"+a.id).addClass(a.dropboxButtonForeColor),$(e).find("#drop-font-btn-"+a.id).addClass(a.dropboxButtonBackColor),$(e).find("#drop-font-btn-"+a.id).addClass(a.dropboxButtonForeColor),$(e).find("#drop-link-btn-"+a.id).text(a.dropboxLinkButtonText),$(e).find("#drop-image-btn-"+a.id).text(a.dropboxImageButtonText),$(e).find("#drop-font-btn-"+a.id).text(a.dropboxFontSizeButtonText),this.linkDrop=new Drop({target:$("#makeLink-"+a.id).first()[0],content:$("#drop-link-"+a.id).html(),position:"bottom center",openOn:"click"}),this.linkDrop.on("open",function(){$(".quit-"+a.id).click(function(){$(this).parent().parent().removeClass("drop-open")}),$(".submitLink-"+a.id).click(function(){var b=d.contentWindow.editor;b.makeLink($(this).parent().children("#url-"+a.id).first().val()),$(this).parent().parent().removeClass("drop-open"),$(this).parent().children("#url-"+a.id).attr("value","")})}),this.imageDrop=new Drop({target:$("#insertImage-"+a.id).first()[0],content:$("#drop-image-"+a.id).html(),position:"bottom center",openOn:"click"}),this.imageDrop.on("open",function(){$(".quit-"+a.id).unbind().click(function(){$(this).parent().parent().removeClass("drop-open")}),$(".sumbitImageURL-"+a.id).unbind().click(function(){var b=d.contentWindow.editor;url=$(this).parent().children("#imageUrl-"+a.id).first()[0],b.insertImage(url.value),$(this).parent().parent().removeClass("drop-open"),$(this).parent().children("#imageUrl-"+a.id).attr("value","")})}),this.fontDrop=new Drop({target:$("#insertFont-"+a.id).first()[0],content:$("#drop-font-"+a.id).html(),position:"bottom center",openOn:"click"}),this.fontDrop.on("open",function(){$(".quit-"+a.id).unbind().click(function(){$(this).parent().parent().removeClass("drop-open")}),$(".sumbitFont-"+a.id).unbind().click(function(){var b=d.contentWindow.editor,c=$(this).parent().children("#font-"+a.id).first()[0].value+"px";"px"!=c&&b.setFontSize(c),$(this).parent().parent().removeClass("drop-open")})}),$(".item-"+a.id).click(function(){var a=$(this).parents(".Squire-UI").next("iframe").first()[0],b=a.contentWindow.editor,c=$(this).data("action");test={value:$(this).data("action"),testBold:b.testPresenceinSelection("bold",c,"B",/>B\b/),testItalic:b.testPresenceinSelection("italic",c,"I",/>I\b/),testUnderline:b.testPresenceinSelection("underline",c,"U",/>U\b/),testOrderedList:b.testPresenceinSelection("makeOrderedList",c,"OL",/>OL\b/),testLink:b.testPresenceinSelection("makeLink",c,"A",/>A\b/),testQuote:b.testPresenceinSelection("increaseQuoteLevel",c,"blockquote",/>blockquote\b/),isNotValue:function(a){return a==c&&""!==this.value}},b.alignRight=function(){b.setTextAlignment("right")},b.alignCenter=function(){b.setTextAlignment("center")},b.alignLeft=function(){b.setTextAlignment("left")},b.alignJustify=function(){b.setTextAlignment("justify")},b.makeHeading=function(){b.setFontSize("2em"),b.bold()},test.testBold|test.testItalic|test.testUnderline|test.testOrderedList|test.testLink|test.testQuote?(test.testBold&&b.removeBold(),test.testItalic&&b.removeItalic(),test.testUnderline&&b.removeUnderline(),test.testLink&&b.removeLink(),test.testOrderedList&&b.removeList(),test.testQuote&&b.decreaseQuoteLevel()):test.isNotValue("makeLink")|test.isNotValue("insertImage")|test.isNotValue("fontsize")||(b[c](),b.focus())})}),d.addEventListener("load",function(){var b=d.contentDocument;"CSS1Compat"!==b.compatMode&&(b.open(),b.write("<!DOCTYPE html><title></title>"),b.close()),d.contentWindow.editor||(d.contentWindow.editor=new Squire(d.contentWindow.document),d.contentWindow.editor.addStyles("html {  height: 100%;}body {  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;  box-sizing: border-box;  height: 100%;  padding: 0em 0em;  background: transparent;  color: "+a.textColor+";  font: 1rem arial, sans-serif;  cursor: text;}a {  text-decoration: underline;}h1 {  font-size: 138.5%;}h2 {  font-size: 123.1%;}h3 {  font-size: 108%;}h1,h2,h3,p {  margin: 1em 0;}h4,h5,h6 {  margin: 0;}ul, ol {  margin: 0 1em;  padding: 0 1em;}blockquote {  border-left: 2px solid "+a.blockQuoteColor+";  margin: 0;  padding: 0 10px;}"),$(d.contentWindow.document).on("keyup keydown autoresize",function(){resizeFrame(d)}),$(window).on("resize",function(){resizeFrame(d)}),d.contentWindow.editor.addEventListener("focus",function(){"true"==d.getAttribute("abmenabled")?$("#"+a.id+"-iframe").css({border:"2px solid "+a.activeBorderColor,"box-shadow":"inset 0 1px 2px rgba(0,0,0,0.075)"}):$("#"+a.id+"-iframe").css({border:"2px solid rgba(0,0,0,0.0)","box-shadow":"inset 0 1px 2px rgba(0,0,0,0.0)"})}),d.contentWindow.editor.addEventListener("blur",function(){"true"==d.getAttribute("abmenabled")?$("#"+a.id+"-iframe").css({border:"2px solid "+a.inactiveBorderColor,"box-shadow":"inset 0 1px 2px rgba(0,0,0,0.075)"}):$("#"+a.id+"-iframe").css({border:"2px solid rgba(0,0,0,0.0)","box-shadow":"inset 0 1px 2px rgba(0,0,0,0.0)"})}),d.contentWindow.editor.addEventListener("pathChange",function(){var b=d.contentWindow.editor,c=$(this).data("action");test={value:$(this).data("action"),testBold:b.checkPresenceinSelection("bold","B",/>B\b/),testItalic:b.checkPresenceinSelection("italic","I",/>I\b/),testUnderline:b.checkPresenceinSelection("underline","U",/>U\b/),testOrderedList:b.checkPresenceinSelection("makeOrderedList","OL",/>OL\b/),testLink:b.checkPresenceinSelection("makeLink","A",/>A\b/),testQuote:b.checkPresenceinSelection("increaseQuoteLevel","blockquote",/>blockquote\b/),isNotValue:function(a){return a==c&&""!==this.value}},test.testBold?$("#"+a.id+"-abm-bold").addClass(a.activeMenuColor):$("#"+a.id+"-abm-bold").removeClass(a.activeMenuColor),test.testItalic?$("#"+a.id+"-abm-italic").addClass(a.activeMenuColor):$("#"+a.id+"-abm-italic").removeClass(a.activeMenuColor),test.testUnderline?$("#"+a.id+"-abm-underline").addClass(a.activeMenuColor):$("#"+a.id+"-abm-underline").removeClass(a.activeMenuColor),test.testOrderedList?$("#"+a.id+"-abm-ordered").addClass(a.activeMenuColor):$("#"+a.id+"-abm-ordered").removeClass(a.activeMenuColor),test.testLink?$("#"+a.id+"-abm-link").addClass(a.activeMenuColor):$("#"+a.id+"-abm-link").removeClass(a.activeMenuColor),test.testQuote?$("#"+a.id+"-abm-quote").addClass(a.activeMenuColor):$("#"+a.id+"-abm-quote").removeClass(a.activeMenuColor)}),a.isEnabled?$("#"+a.id+"-iframe").css({border:"2px solid "+a.inactiveBorderColor,"background-color":a.backColor,"box-shadow":"inset 0 1px 2px rgba(0,0,0,0.075)"}):$("#"+a.id+"-iframe").css({border:"2px solid rgba(0,0,0,0.0)","background-color":a.backColor,"box-shadow":"inset 0 1px 2px rgba(0,0,0,0.0)"}),resizeFrame(d))}),$(b).append(e),$(b).append(d),""==a.arrayName?b4j_raiseEvent("page_parseevent",{eventname:a.realId+"_loaded",eventparams:"target",target:a.realId}):b4j_raiseEvent("page_parseevent",{eventname:a.arrayName+"_loaded",eventparams:"target",target:a.realId}),d.contentWindow?d.contentWindow.editor:null}}),!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b(require,exports,module):a.Tether=b()}(this,function(){return function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r={}.hasOwnProperty,s=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},t=[].slice;null==this.Tether&&(this.Tether={modules:[]}),k=function(a){var b,c,d,e,f;if(c=getComputedStyle(a).position,"fixed"===c)return a;for(d=void 0,b=a;b=b.parentNode;){try{e=getComputedStyle(b)}catch(a){}if(null==e)return b;if(/(auto|scroll)/.test(e.overflow+e["overflow-y"]+e["overflow-x"])&&("absolute"!==c||"relative"===(f=e.position)||"absolute"===f||"fixed"===f))return b}return document.body},o=function(){var a;return a=0,function(){return a++}}(),q={},i=function(a){var b,d,f,g,h;if(f=a._tetherZeroElement,null==f&&(f=a.createElement("div"),f.setAttribute("data-tether-id",o()),e(f.style,{top:0,left:0,position:"absolute"}),a.body.appendChild(f),a._tetherZeroElement=f),b=f.getAttribute("data-tether-id"),null==q[b]){q[b]={},h=f.getBoundingClientRect();for(d in h)g=h[d],q[b][d]=g;c(function(){return q[b]=void 0})}return q[b]},m=null,g=function(a){var b,c,d,e,f,g,h;a===document?(c=document,a=document.documentElement):c=a.ownerDocument,d=c.documentElement,b={},h=a.getBoundingClientRect();for(e in h)g=h[e],b[e]=g;return f=i(c),b.top-=f.top,b.left-=f.left,null==b.width&&(b.width=document.body.scrollWidth-b.left-b.right),null==b.height&&(b.height=document.body.scrollHeight-b.top-b.bottom),b.top=b.top-d.clientTop,b.left=b.left-d.clientLeft,b.right=c.body.clientWidth-b.width-b.left,b.bottom=c.body.clientHeight-b.height-b.top,b},h=function(a){return a.offsetParent||document.documentElement},j=function(){var a,b,c,d,f;return a=document.createElement("div"),a.style.width="100%",a.style.height="200px",b=document.createElement("div"),e(b.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),b.appendChild(a),document.body.appendChild(b),d=a.offsetWidth,b.style.overflow="scroll",f=a.offsetWidth,d===f&&(f=b.clientWidth),document.body.removeChild(b),c=d-f,{width:c,height:c}},e=function(a){var b,c,d,e,f,g,h;for(null==a&&(a={}),b=[],Array.prototype.push.apply(b,arguments),h=b.slice(1),f=0,g=h.length;g>f;f++)if(d=h[f])for(c in d)r.call(d,c)&&(e=d[c],a[c]=e);return a},n=function(a,b){var c,d,e,f,g;if(null!=a.classList){for(f=b.split(" "),g=[],d=0,e=f.length;e>d;d++)c=f[d],c.trim()&&g.push(a.classList.remove(c));return g}return a.className=a.className.replace(new RegExp("(^| )"+b.split(" ").join("|")+"( |$)","gi")," ")},b=function(a,b){var c,d,e,f,g;if(null!=a.classList){for(f=b.split(" "),g=[],d=0,e=f.length;e>d;d++)c=f[d],c.trim()&&g.push(a.classList.add(c));return g}return n(a,b),a.className+=" "+b},l=function(a,b){return null!=a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)},p=function(a,c,d){var e,f,g,h,i,j;for(f=0,h=d.length;h>f;f++)e=d[f],s.call(c,e)<0&&l(a,e)&&n(a,e);for(j=[],g=0,i=c.length;i>g;g++)e=c[g],j.push(l(a,e)?void 0:b(a,e));return j},d=[],c=function(a){return d.push(a)},f=function(){var a,b;for(b=[];a=d.pop();)b.push(a());return b},a=function(){function a(){}return a.prototype.on=function(a,b,c,d){var e;return null==d&&(d=!1),null==this.bindings&&(this.bindings={}),null==(e=this.bindings)[a]&&(e[a]=[]),this.bindings[a].push({handler:b,ctx:c,once:d})},a.prototype.once=function(a,b,c){return this.on(a,b,c,!0)},a.prototype.off=function(a,b){var c,d,e;if(null!=(null!=(d=this.bindings)?d[a]:void 0)){if(null==b)return delete this.bindings[a];for(c=0,e=[];c<this.bindings[a].length;)e.push(this.bindings[a][c].handler===b?this.bindings[a].splice(c,1):c++);return e}},a.prototype.trigger=function(){var a,b,c,d,e,f,g,h,i;if(c=arguments[0],a=2<=arguments.length?t.call(arguments,1):[],null!=(g=this.bindings)?g[c]:void 0){for(e=0,i=[];e<this.bindings[c].length;)h=this.bindings[c][e],d=h.handler,b=h.ctx,f=h.once,d.apply(null!=b?b:this,a),i.push(f?this.bindings[c].splice(e,1):e++);return i}},a}(),this.Tether.Utils={getScrollParent:k,getBounds:g,getOffsetParent:h,extend:e,addClass:b,removeClass:n,hasClass:l,updateClasses:p,defer:c,flush:f,uniqueId:o,Evented:a,getScrollBarSize:j}}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=[].slice,E=function(a,b){return function(){return a.apply(b,arguments)}};if(null==this.Tether)throw new Error("You must include the utils.js file before tether.js");d=this.Tether,C=d.Utils,p=C.getScrollParent,q=C.getSize,n=C.getOuterSize,l=C.getBounds,m=C.getOffsetParent,j=C.extend,e=C.addClass,w=C.removeClass,z=C.updateClasses,i=C.defer,k=C.flush,o=C.getScrollBarSize,A=function(a,b,c){return null==c&&(c=1),a+c>=b&&b>=a-c},y=function(){var a,b,c,d,e;for(a=document.createElement("div"),e=["transform","webkitTransform","OTransform","MozTransform","msTransform"],c=0,d=e.length;d>c;c++)if(b=e[c],void 0!==a.style[b])return b}(),x=[],v=function(){var a,b,c;for(b=0,c=x.length;c>b;b++)a=x[b],a.position(!1);return k()},r=function(){var a;return null!=(a="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?a:+new Date},function(){var a,b,c,d,e,f,g,h,i;for(b=null,c=null,d=null,e=function(){return null!=c&&c>16?(c=Math.min(c-16,250),void(d=setTimeout(e,250))):null!=b&&r()-b<10?void 0:(null!=d&&(clearTimeout(d),d=null),b=r(),v(),c=r()-b)},h=["resize","scroll","touchmove"],i=[],f=0,g=h.length;g>f;f++)a=h[f],i.push(window.addEventListener(a,e));return i}(),a={center:"center",left:"right",right:"left"},b={middle:"middle",top:"bottom",bottom:"top"},c={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},h=function(c,d){var e,f;return e=c.left,f=c.top,"auto"===e&&(e=a[d.left]),"auto"===f&&(f=b[d.top]),{left:e,top:f}},g=function(a){var b,d;return{left:null!=(b=c[a.left])?b:a.left,top:null!=(d=c[a.top])?d:a.top}},f=function(){var a,b,c,d,e,f,g;for(b=1<=arguments.length?D.call(arguments,0):[],c={top:0,left:0},e=0,f=b.length;f>e;e++)g=b[e],d=g.top,a=g.left,"string"==typeof d&&(d=parseFloat(d,10)),"string"==typeof a&&(a=parseFloat(a,10)),c.top+=d,c.left+=a;return c},s=function(a,b){return"string"==typeof a.left&&-1!==a.left.indexOf("%")&&(a.left=parseFloat(a.left,10)/100*b.width),"string"==typeof a.top&&-1!==a.top.indexOf("%")&&(a.top=parseFloat(a.top,10)/100*b.height),a},t=u=function(a){var b,c,d;return d=a.split(" "),c=d[0],b=d[1],{top:c,left:b}},B=function(){function a(a){this.position=E(this.position,this);var b,c,e,f,g;for(x.push(this),this.history=[],this.setOptions(a,!1),f=d.modules,c=0,e=f.length;e>c;c++)b=f[c],null!=(g=b.initialize)&&g.call(this);this.position()}return a.modules=[],a.prototype.getClass=function(a){var b,c;return(null!=(b=this.options.classes)?b[a]:void 0)?this.options.classes[a]:(null!=(c=this.options.classes)?c[a]:void 0)!==!1?this.options.classPrefix?""+this.options.classPrefix+"-"+a:a:""},a.prototype.setOptions=function(a,b){var c,d,f,g,h,i;for(this.options=a,null==b&&(b=!0),c={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"},this.options=j(c,this.options),h=this.options,this.element=h.element,this.target=h.target,this.targetModifier=h.targetModifier,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),i=["element","target"],f=0,g=i.length;g>f;f++){if(d=i[f],null==this[d])throw new Error("Tether Error: Both element and target must be defined");null!=this[d].jquery?this[d]=this[d][0]:"string"==typeof this[d]&&(this[d]=document.querySelector(this[d]))}if(e(this.element,this.getClass("element")),e(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");return this.targetAttachment=t(this.options.targetAttachment),this.attachment=t(this.options.attachment),this.offset=u(this.options.offset),this.targetOffset=u(this.options.targetOffset),null!=this.scrollParent&&this.disable(),this.scrollParent="scroll-handle"===this.targetModifier?this.target:p(this.target),this.options.enabled!==!1?this.enable(b):void 0},a.prototype.getTargetBounds=function(){var a,b,c,d,e,f,g,h,i;if(null==this.targetModifier)return l(this.target);switch(this.targetModifier){case"visible":return this.target===document.body?{
top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth}:(a=l(this.target),e={height:a.height,width:a.width,top:a.top,left:a.left},e.height=Math.min(e.height,a.height-(pageYOffset-a.top)),e.height=Math.min(e.height,a.height-(a.top+a.height-(pageYOffset+innerHeight))),e.height=Math.min(innerHeight,e.height),e.height-=2,e.width=Math.min(e.width,a.width-(pageXOffset-a.left)),e.width=Math.min(e.width,a.width-(a.left+a.width-(pageXOffset+innerWidth))),e.width=Math.min(innerWidth,e.width),e.width-=2,e.top<pageYOffset&&(e.top=pageYOffset),e.left<pageXOffset&&(e.left=pageXOffset),e);case"scroll-handle":return i=this.target,i===document.body?(i=document.documentElement,a={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):a=l(i),h=getComputedStyle(i),c=i.scrollWidth>i.clientWidth||"scroll"===[h.overflow,h.overflowX]||this.target!==document.body,f=0,c&&(f=15),d=a.height-parseFloat(h.borderTopWidth)-parseFloat(h.borderBottomWidth)-f,e={width:15,height:.975*d*(d/i.scrollHeight),left:a.left+a.width-parseFloat(h.borderLeftWidth)-15},b=0,408>d&&this.target===document.body&&(b=-11e-5*Math.pow(d,2)-.00727*d+22.58),this.target!==document.body&&(e.height=Math.max(e.height,24)),g=this.target.scrollTop/(i.scrollHeight-d),e.top=g*(d-e.height-b)+a.top+parseFloat(h.borderTopWidth),this.target===document.body&&(e.height=Math.max(e.height,24)),e}},a.prototype.clearCache=function(){return this._cache={}},a.prototype.cache=function(a,b){return null==this._cache&&(this._cache={}),null==this._cache[a]&&(this._cache[a]=b.call(this)),this._cache[a]},a.prototype.enable=function(a){return null==a&&(a=!0),e(this.target,this.getClass("enabled")),e(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParent!==document&&this.scrollParent.addEventListener("scroll",this.position),a?this.position():void 0},a.prototype.disable=function(){return w(this.target,this.getClass("enabled")),w(this.element,this.getClass("enabled")),this.enabled=!1,null!=this.scrollParent?this.scrollParent.removeEventListener("scroll",this.position):void 0},a.prototype.destroy=function(){var a,b,c,d,e;for(this.disable(),e=[],a=c=0,d=x.length;d>c;a=++c){if(b=x[a],b===this){x.splice(a,1);break}e.push(void 0)}return e},a.prototype.updateAttachClasses=function(a,b){var c,d,e,f,g,h,j,k,l,m=this;for(null==a&&(a=this.attachment),null==b&&(b=this.targetAttachment),f=["left","top","bottom","right","middle","center"],(null!=(l=this._addAttachClasses)?l.length:void 0)&&this._addAttachClasses.splice(0,this._addAttachClasses.length),c=null!=this._addAttachClasses?this._addAttachClasses:this._addAttachClasses=[],a.top&&c.push(""+this.getClass("element-attached")+"-"+a.top),a.left&&c.push(""+this.getClass("element-attached")+"-"+a.left),b.top&&c.push(""+this.getClass("target-attached")+"-"+b.top),b.left&&c.push(""+this.getClass("target-attached")+"-"+b.left),d=[],g=0,j=f.length;j>g;g++)e=f[g],d.push(""+this.getClass("element-attached")+"-"+e);for(h=0,k=f.length;k>h;h++)e=f[h],d.push(""+this.getClass("target-attached")+"-"+e);return i(function(){return null!=m._addAttachClasses?(z(m.element,m._addAttachClasses,d),z(m.target,m._addAttachClasses,d),m._addAttachClasses=void 0):void 0})},a.prototype.position=function(a){var b,c,e,i,j,n,p,q,r,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T=this;if(null==a&&(a=!0),this.enabled){for(this.clearCache(),D=h(this.targetAttachment,this.attachment),this.updateAttachClasses(this.attachment,D),b=this.cache("element-bounds",function(){return l(T.element)}),I=b.width,e=b.height,0===I&&0===e&&null!=this.lastSize?(N=this.lastSize,I=N.width,e=N.height):this.lastSize={width:I,height:e},G=F=this.cache("target-bounds",function(){return T.getTargetBounds()}),r=s(g(this.attachment),{width:I,height:e}),E=s(g(D),G),j=s(this.offset,{width:I,height:e}),n=s(this.targetOffset,G),r=f(r,j),E=f(E,n),i=F.left+E.left-r.left,H=F.top+E.top-r.top,O=d.modules,J=0,L=O.length;L>J;J++)if(p=O[J],y=p.position.call(this,{left:i,top:H,targetAttachment:D,targetPos:F,attachment:this.attachment,elementPos:b,offset:r,targetOffset:E,manualOffset:j,manualTargetOffset:n,scrollbarSize:B}),null!=y&&"object"==typeof y){if(y===!1)return!1;H=y.top,i=y.left}if(q={page:{top:H,left:i},viewport:{top:H-pageYOffset,bottom:pageYOffset-H-e+innerHeight,left:i-pageXOffset,right:pageXOffset-i-I+innerWidth}},document.body.scrollWidth>window.innerWidth&&(B=this.cache("scrollbar-size",o),q.viewport.bottom-=B.height),document.body.scrollHeight>window.innerHeight&&(B=this.cache("scrollbar-size",o),q.viewport.right-=B.width),(""!==(P=document.body.style.position)&&"static"!==P||""!==(Q=document.body.parentElement.style.position)&&"static"!==Q)&&(q.page.bottom=document.body.scrollHeight-H-e,q.page.right=document.body.scrollWidth-i-I),(null!=(R=this.options.optimizations)?R.moveElement:void 0)!==!1&&null==this.targetModifier){for(u=this.cache("target-offsetparent",function(){return m(T.target)}),x=this.cache("target-offsetparent-bounds",function(){return l(u)}),w=getComputedStyle(u),c=getComputedStyle(this.element),v=x,t={},S=["Top","Left","Bottom","Right"],K=0,M=S.length;M>K;K++)C=S[K],t[C.toLowerCase()]=parseFloat(w["border"+C+"Width"]);x.right=document.body.scrollWidth-x.left-v.width+t.right,x.bottom=document.body.scrollHeight-x.top-v.height+t.bottom,q.page.top>=x.top+t.top&&q.page.bottom>=x.bottom&&q.page.left>=x.left+t.left&&q.page.right>=x.right&&(A=u.scrollTop,z=u.scrollLeft,q.offset={top:q.page.top-x.top+A-t.top,left:q.page.left-x.left+z-t.left})}return this.move(q),this.history.unshift(q),this.history.length>3&&this.history.pop(),a&&k(),!0}},a.prototype.move=function(a){var b,c,d,e,f,g,h,k,l,n,o,p,q,r,s,t,u,v=this;if(null!=this.element.parentNode){k={};for(n in a){k[n]={};for(e in a[n]){for(d=!1,t=this.history,r=0,s=t.length;s>r;r++)if(h=t[r],!A(null!=(u=h[n])?u[e]:void 0,a[n][e])){d=!0;break}d||(k[n][e]=!0)}}b={top:"",left:"",right:"",bottom:""},l=function(a,c){var d,e,f;return(null!=(f=v.options.optimizations)?f.gpu:void 0)===!1?(a.top?b.top=""+c.top+"px":b.bottom=""+c.bottom+"px",a.left?b.left=""+c.left+"px":b.right=""+c.right+"px"):(a.top?(b.top=0,e=c.top):(b.bottom=0,e=-c.bottom),a.left?(b.left=0,d=c.left):(b.right=0,d=-c.right),b[y]="translateX("+Math.round(d)+"px) translateY("+Math.round(e)+"px)","msTransform"!==y?b[y]+=" translateZ(0)":void 0)},f=!1,(k.page.top||k.page.bottom)&&(k.page.left||k.page.right)?(b.position="absolute",l(k.page,a.page)):(k.viewport.top||k.viewport.bottom)&&(k.viewport.left||k.viewport.right)?(b.position="fixed",l(k.viewport,a.viewport)):null!=k.offset&&k.offset.top&&k.offset.left?(b.position="absolute",g=this.cache("target-offsetparent",function(){return m(v.target)}),m(this.element)!==g&&i(function(){return v.element.parentNode.removeChild(v.element),g.appendChild(v.element)}),l(k.offset,a.offset),f=!0):(b.position="absolute",l({top:!0,left:!0},a.page)),f||"BODY"===this.element.parentNode.tagName||(this.element.parentNode.removeChild(this.element),document.body.appendChild(this.element)),q={},p=!1;for(e in b)o=b[e],c=this.element.style[e],""===c||""===o||"top"!==e&&"left"!==e&&"bottom"!==e&&"right"!==e||(c=parseFloat(c),o=parseFloat(o)),c!==o&&(p=!0,q[e]=b[e]);return p?i(function(){return j(v.element.style,q)}):void 0}},a}(),d.position=v,this.Tether=j(B,d)}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};j=this.Tether.Utils,g=j.getOuterSize,f=j.getBounds,h=j.getSize,d=j.extend,i=j.updateClasses,c=j.defer,b={left:"right",right:"left",top:"bottom",bottom:"top",middle:"middle"},a=["left","top","right","bottom"],e=function(b,c){var d,e,g,h,i,j,k;if("scrollParent"===c?c=b.scrollParent:"window"===c&&(c=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),c===document&&(c=c.documentElement),null!=c.nodeType)for(e=h=f(c),i=getComputedStyle(c),c=[e.left,e.top,h.width+e.left,h.height+e.top],d=j=0,k=a.length;k>j;d=++j)g=a[d],g=g[0].toUpperCase()+g.substr(1),"Top"===g||"Left"===g?c[d]+=parseFloat(i["border"+g+"Width"]):c[d]-=parseFloat(i["border"+g+"Width"]);return c},this.Tether.modules.push({position:function(b){var g,h,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba=this;if(H=b.top,s=b.left,C=b.targetAttachment,!this.options.constraints)return!0;for(z=function(b){var c,d,e,f;for(ba.removeClass(b),f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(ba.removeClass(""+b+"-"+c));return f},V=this.cache("element-bounds",function(){return f(ba.element)}),r=V.height,I=V.width,0===I&&0===r&&null!=this.lastSize&&(W=this.lastSize,I=W.width,r=W.height),E=this.cache("target-bounds",function(){return ba.getTargetBounds()}),D=E.height,F=E.width,B={},q={},h=[this.getClass("pinned"),this.getClass("out-of-bounds")],X=this.options.constraints,J=0,N=X.length;N>J;J++)p=X[J],p.outOfBoundsClass&&h.push(p.outOfBoundsClass),p.pinnedClass&&h.push(p.pinnedClass);for(K=0,O=h.length;O>K;K++)for(o=h[K],Y=["left","top","right","bottom"],L=0,P=Y.length;P>L;L++)A=Y[L],h.push(""+o+"-"+A);for(g=[],B=d({},C),q=d({},this.attachment),Z=this.options.constraints,M=0,Q=Z.length;Q>M;M++){if(p=Z[M],G=p.to,j=p.attachment,w=p.pin,null==j&&(j=""),k.call(j," ")>=0?($=j.split(" "),n=$[0],m=$[1]):m=n=j,l=e(this,G),("target"===n||"both"===n)&&(H<l[1]&&"top"===B.top&&(H+=D,B.top="bottom"),H+r>l[3]&&"bottom"===B.top&&(H-=D,B.top="top")),"together"===n&&(H<l[1]&&"top"===B.top&&("bottom"===q.top?(H+=D,B.top="bottom",H+=r,q.top="top"):"top"===q.top&&(H+=D,B.top="bottom",H-=r,q.top="bottom")),H+r>l[3]&&"bottom"===B.top&&("top"===q.top?(H-=D,B.top="top",H-=r,q.top="bottom"):"bottom"===q.top&&(H-=D,B.top="top",H+=r,q.top="top")),"middle"===B.top&&(H+r>l[3]&&"top"===q.top?(H-=r,q.top="bottom"):H<l[1]&&"bottom"===q.top&&(H+=r,q.top="top"))),("target"===m||"both"===m)&&(s<l[0]&&"left"===B.left&&(s+=F,B.left="right"),s+I>l[2]&&"right"===B.left&&(s-=F,B.left="left")),"together"===m&&(s<l[0]&&"left"===B.left?"right"===q.left?(s+=F,B.left="right",s+=I,q.left="left"):"left"===q.left&&(s+=F,B.left="right",s-=I,q.left="right"):s+I>l[2]&&"right"===B.left?"left"===q.left?(s-=F,B.left="left",s-=I,q.left="right"):"right"===q.left&&(s-=F,B.left="left",s+=I,q.left="left"):"center"===B.left&&(s+I>l[2]&&"left"===q.left?(s-=I,q.left="right"):s<l[0]&&"right"===q.left&&(s+=I,q.left="left"))),("element"===n||"both"===n)&&(H<l[1]&&"bottom"===q.top&&(H+=r,q.top="top"),H+r>l[3]&&"top"===q.top&&(H-=r,q.top="bottom")),("element"===m||"both"===m)&&(s<l[0]&&"right"===q.left&&(s+=I,q.left="left"),s+I>l[2]&&"left"===q.left&&(s-=I,q.left="right")),"string"==typeof w?w=function(){var a,b,c,d;for(c=w.split(","),d=[],b=0,a=c.length;a>b;b++)v=c[b],d.push(v.trim());return d}():w===!0&&(w=["top","left","right","bottom"]),w||(w=[]),x=[],t=[],H<l[1]&&(k.call(w,"top")>=0?(H=l[1],x.push("top")):t.push("top")),H+r>l[3]&&(k.call(w,"bottom")>=0?(H=l[3]-r,x.push("bottom")):t.push("bottom")),s<l[0]&&(k.call(w,"left")>=0?(s=l[0],x.push("left")):t.push("left")),s+I>l[2]&&(k.call(w,"right")>=0?(s=l[2]-I,x.push("right")):t.push("right")),x.length)for(y=null!=(_=this.options.pinnedClass)?_:this.getClass("pinned"),g.push(y),T=0,R=x.length;R>T;T++)A=x[T],g.push(""+y+"-"+A);if(t.length)for(u=null!=(aa=this.options.outOfBoundsClass)?aa:this.getClass("out-of-bounds"),g.push(u),U=0,S=t.length;S>U;U++)A=t[U],g.push(""+u+"-"+A);(k.call(x,"left")>=0||k.call(x,"right")>=0)&&(q.left=B.left=!1),(k.call(x,"top")>=0||k.call(x,"bottom")>=0)&&(q.top=B.top=!1),(B.top!==C.top||B.left!==C.left||q.top!==this.attachment.top||q.left!==this.attachment.left)&&this.updateAttachClasses(q,B)}return c(function(){return i(ba.target,g,h),i(ba.element,g,h)}),{top:H,left:s}}})}.call(this),function(){var a,b,c,d;d=this.Tether.Utils,b=d.getBounds,c=d.updateClasses,a=d.defer,this.Tether.modules.push({position:function(d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this;if(o=d.top,j=d.left,y=this.cache("element-bounds",function(){return b(D.element)}),i=y.height,p=y.width,n=this.getTargetBounds(),h=o+i,k=j+p,e=[],o<=n.bottom&&h>=n.top)for(z=["left","right"],q=0,u=z.length;u>q;q++)l=z[q],((A=n[l])===j||A===k)&&e.push(l);if(j<=n.right&&k>=n.left)for(B=["top","bottom"],r=0,v=B.length;v>r;r++)l=B[r],((C=n[l])===o||C===h)&&e.push(l);for(g=[],f=[],m=["left","top","right","bottom"],g.push(this.getClass("abutted")),s=0,w=m.length;w>s;s++)l=m[s],g.push(""+this.getClass("abutted")+"-"+l);for(e.length&&f.push(this.getClass("abutted")),t=0,x=e.length;x>t;t++)l=e[t],f.push(""+this.getClass("abutted")+"-"+l);return a(function(){return c(D.target,f,g),c(D.element,f,g)}),!0}})}.call(this),function(){this.Tether.modules.push({position:function(a){var b,c,d,e,f,g,h;return g=a.top,b=a.left,this.options.shift?(c=function(a){return"function"==typeof a?a.call(this,{top:g,left:b}):a},d=c(this.options.shift),"string"==typeof d?(d=d.split(" "),d[1]||(d[1]=d[0]),f=d[0],e=d[1],f=parseFloat(f,10),e=parseFloat(e,10)):(h=[d.top,d.left],f=h[0],e=h[1]),g+=f,b+=e,{top:g,left:b}):void 0}})}.call(this),this.Tether}),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s={}.hasOwnProperty,t=function(a,b){function c(){this.constructor=a}for(var d in b)s.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},u=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};r=Tether.Utils,h=r.extend,c=r.addClass,k=r.removeClass,i=r.hasClass,a=r.Evented,o="ontouchstart"in document.documentElement,e=["click"],o&&e.push("touchstart"),q={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"},p="";for(j in q)g=q[j],n=document.createElement("p"),void 0!==n.style[j]&&(p=g);m=function(a){var b,c,d,e;return d=a.split(" "),b=d[0],c=d[1],("left"===b||"right"===b)&&(e=[c,b],b=e[0],c=e[1]),[b,c].join(" ")},b={left:"right",right:"left",top:"bottom",bottom:"top",middle:"middle",center:"center"},d={},l=function(a,b){var c,d;for(d=[];-1!==(c=a.indexOf(b));)d.push(a.splice(c,1));return d},f=function(g){var j,n,o,q;return null==g&&(g={}),o=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(j,arguments,function(){})},h(o,{createContext:f,drops:[],defaults:{}}),n={classPrefix:"drop",defaults:{position:"bottom left",openOn:"click",constrainToScrollParent:!0,constrainToWindow:!0,classes:"",remove:!1,tetherOptions:{}}},h(o,n,g),h(o.defaults,n.defaults,g.defaults),null==d[q=o.classPrefix]&&(d[q]=[]),o.updateBodyClasses=function(){var a,b,e,f,g;for(a=!1,g=d[o.classPrefix],e=0,f=g.length;f>e;e++)if(b=g[e],b.isOpened()){a=!0;break}return a?c(document.body,""+o.classPrefix+"-open"):k(document.body,""+o.classPrefix+"-open")},j=function(a){function f(a){if(this.options=a,this.options=h({},o.defaults,this.options),this.target=this.options.target,null==this.target)throw new Error("Drop Error: You must provide a target.");this.options.classes&&c(this.target,this.options.classes),o.drops.push(this),d[o.classPrefix].push(this),this._boundEvents=[],this.setupElements(),this.setupEvents(),this.setupTether()}return t(f,a),f.prototype._on=function(a,b,c){return this._boundEvents.push({element:a,event:b,handler:c}),a.addEventListener(b,c)},f.prototype.setupElements=function(){return this.drop=document.createElement("div"),c(this.drop,o.classPrefix),this.options.classes&&c(this.drop,this.options.classes),this.content=document.createElement("div"),c(this.content,""+o.classPrefix+"-content"),"object"==typeof this.options.content?this.content.appendChild(this.options.content):this.content.innerHTML=this.options.content,this.drop.appendChild(this.content)},f.prototype.setupTether=function(){var a,c;return c=this.options.position.split(" "),c[0]=b[c[0]],c=c.join(" "),a=[],a.push(this.options.constrainToScrollParent?{to:"scrollParent",pin:"top, bottom",attachment:"together none"}:{to:"scrollParent"}),a.push(this.options.constrainToWindow!==!1?{to:"window",attachment:"together"}:{to:"window"}),g={element:this.drop,target:this.target,attachment:m(c),targetAttachment:m(this.options.position),classPrefix:o.classPrefix,offset:"0 0",targetOffset:"0 0",enabled:!1,constraints:a},this.options.tetherOptions!==!1?this.tether=new Tether(h({},g,this.options.tetherOptions)):void 0},f.prototype.setupEvents=function(){var a,b,c,d,f,g,h,i,j,k,l=this;if(this.options.openOn){if("always"===this.options.openOn)return void setTimeout(this.open.bind(this));if(c=this.options.openOn.split(" "),u.call(c,"click")>=0)for(f=function(a){return l.toggle(),a.preventDefault()},b=function(a){return!l.isOpened()||a.target===l.drop||l.drop.contains(a.target)||a.target===l.target||l.target.contains(a.target)?void 0:l.close()},j=0,k=e.length;k>j;j++)a=e[j],this._on(this.target,a,f),this._on(document,a,b);return u.call(c,"hover")>=0?(d=!1,i=function(){return d=!0,l.open()},h=null,g=function(){return d=!1,null!=h&&clearTimeout(h),h=setTimeout(function(){return d||l.close(),h=null},50)},this._on(this.target,"mouseover",i),this._on(this.drop,"mouseover",i),this._on(this.target,"mouseout",g),this._on(this.drop,"mouseout",g)):void 0}},f.prototype.isOpened=function(){return i(this.drop,""+o.classPrefix+"-open")},f.prototype.toggle=function(){return this.isOpened()?this.close():this.open()},f.prototype.open=function(){var a,b,d=this;if(!this.isOpened())return this.drop.parentNode||document.body.appendChild(this.drop),null!=(a=this.tether)&&a.enable(),c(this.drop,""+o.classPrefix+"-open"),c(this.drop,""+o.classPrefix+"-open-transitionend"),setTimeout(function(){return c(d.drop,""+o.classPrefix+"-after-open")}),null!=(b=this.tether)&&b.position(),this.trigger("open"),o.updateBodyClasses()},f.prototype.close=function(){var a,b,c=this;if(this.isOpened())return k(this.drop,""+o.classPrefix+"-open"),k(this.drop,""+o.classPrefix+"-after-open"),this.drop.addEventListener(p,a=function(){return i(c.drop,""+o.classPrefix+"-open")||k(c.drop,""+o.classPrefix+"-open-transitionend"),c.drop.removeEventListener(p,a)}),this.trigger("close"),null!=(b=this.tether)&&b.disable(),o.updateBodyClasses(),this.options.remove?this.remove():void 0},f.prototype.remove=function(){var a;return this.close(),null!=(a=this.drop.parentNode)?a.removeChild(this.drop):void 0},f.prototype.position=function(){var a;return this.isOpened()&&null!=(a=this.tether)?a.position():void 0},f.prototype.destroy=function(){var a,b,c,e,f,g,h,i;for(this.remove(),null!=(g=this.tether)&&g.destroy(),h=this._boundEvents,e=0,f=h.length;f>e;e++)i=h[e],a=i.element,b=i.event,c=i.handler,a.removeEventListener(b,c);return this._boundEvents=[],this.tether=null,this.drop=null,this.content=null,this.target=null,l(d[o.classPrefix],this),l(o.drops,this)},f}(a),o},window.Drop=f(),document.addEventListener("DOMContentLoaded",function(){return Drop.updateBodyClasses()})}.call(this);